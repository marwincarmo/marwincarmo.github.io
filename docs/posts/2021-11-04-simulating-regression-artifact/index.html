<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019)</title>

<meta property="description" itemprop="description" content="A short description of the post."/>

<link rel="canonical" href="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-11-04"/>
<meta property="article:created" itemprop="dateCreated" content="2021-11-04"/>
<meta name="article:author" content="Marwin Carmo"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019)"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A short description of the post."/>
<meta property="og:url" content="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"/>
<meta property="og:image" content="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/simulating-regression-artifact_files/figure-html5/sim-plot-1-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Marwin Carmo"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019)"/>
<meta property="twitter:description" content="A short description of the post."/>
<meta property="twitter:url" content="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"/>
<meta property="twitter:image" content="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/simulating-regression-artifact_files/figure-html5/sim-plot-1-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>
<meta property="twitter:site" content="@marwincarmo"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019)"/>
<meta name="citation_fulltext_html_url" content="https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2021/11/04"/>
<meta name="citation_publication_date" content="2021/11/04"/>
<meta name="citation_author" content="Marwin Carmo"/>
<meta name="citation_author_institution" content="University of São Paulo"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Continuous predictors of pretest-posttest change: Highlighting the impact of the regression artifact;citation_publication_date=2019;citation_volume=4;citation_doi=10/gk92gx;citation_author=Linda Farmus;citation_author=Chantal A. Arpin-Cribbie;citation_author=Robert A. Cribbie"/>
  <meta name="citation_reference" content="citation_title=It’s time! 10 + 1 reasons we should start replicating simulation studies;citation_publication_date=2021;citation_doi=10.31234/osf.io/agsnt;citation_author=Anna Lohmann;citation_author=Oscar Lorenzo Olvera Astivia;citation_author=Tim Morris;citation_author=Rolf H. H. Groenwold"/>
  <meta name="citation_reference" content="citation_title=Cause for concern;citation_publication_date=2021;citation_publisher=LinkedIn;citation_author=Stephen Senn"/>
  <meta name="citation_reference" content="citation_title=Lord’s Paradox Revisited  (Oh Lord! Kumbaya!);citation_publication_date=2016;citation_volume=4;citation_doi=10.1515/jci-2016-0021;citation_author=Judea Pearl"/>
  <meta name="citation_reference" content="citation_title=Models for longitudinal experiments – pre-post designs;citation_publication_date=2021;citation_author=J A Walker"/>
  <meta name="citation_reference" content="citation_title=A paradox in the interpretation of group comparisons.;citation_publication_date=1967;citation_volume=68;citation_doi=10.1037/h0025105;citation_author=Frederic M. Lord"/>
  <meta name="citation_reference" content="citation_title=Lord’s Paradox in a Continuous Setting and a Regression Artifact in Numerical Cognition Research;citation_publication_date=2014;citation_publisher=Public Library of Science;citation_volume=9;citation_doi=10/f2z5hc;citation_issn=1932-6203;citation_author=Kimmo Eriksson;citation_author=Olle Häggström"/>
  <meta name="citation_reference" content="citation_title=Comparing groups in a before-after design: When t test and ANCOVA produce different results;citation_publication_date=2006;citation_volume=76;citation_doi=10.1348/000709905x52210;citation_author=Daniel B. Wright"/>
  <meta name="citation_reference" content="citation_title=Explaining lord’s paradox in introductory statistical theory courses;citation_publication_date=2018;citation_volume=7;citation_doi=10.5539/ijsp.v7n4p1;citation_author=Steven B. Kim"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","bibliography","csl","date","categories","output","creative_commons","draft","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Regression Artifact - Re-running Farmus et. al (2019)"]},{"type":"character","attributes":{},"value":["A short description of the post."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["first_name","last_name","url","affiliation","affilitation_url"]}},"value":[{"type":"character","attributes":{},"value":["Marwin"]},{"type":"character","attributes":{},"value":["Carmo"]},{"type":"character","attributes":{},"value":["https://github.com/marwincarmo"]},{"type":"character","attributes":{},"value":["University of São Paulo"]},{"type":"character","attributes":{},"value":["https://www3.fm.usp.br/en/portal/"]}]}]},{"type":"character","attributes":{},"value":["reg.bib"]},{"type":"character","attributes":{},"value":["apa.csl"]},{"type":"character","attributes":{},"value":["2021-11-04"]},{"type":"character","attributes":{},"value":["simulation","regression"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["code_folding","highlight","self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["rstudio"]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"]},{"type":"character","attributes":{},"value":["https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["apa.csl","img/dag2.jpg","img/de1.jpg","reg.bib","simulating-regression-artifact_files/anchor-4.2.2/anchor.min.js","simulating-regression-artifact_files/bowser-1.9.3/bowser.min.js","simulating-regression-artifact_files/distill-2.2.21/template.v2.js","simulating-regression-artifact_files/figure-html5/hist-K-1.png","simulating-regression-artifact_files/figure-html5/sim-plot-1-1.png","simulating-regression-artifact_files/header-attrs-2.11/header-attrs.js","simulating-regression-artifact_files/jquery-3.6.0/jquery-3.6.0.js","simulating-regression-artifact_files/jquery-3.6.0/jquery-3.6.0.min.js","simulating-regression-artifact_files/jquery-3.6.0/jquery-3.6.0.min.map","simulating-regression-artifact_files/kePrint-0.0.1/kePrint.js","simulating-regression-artifact_files/lightable-0.0.1/lightable.css","simulating-regression-artifact_files/popper-2.6.0/popper.min.js","simulating-regression-artifact_files/tippy-6.2.7/tippy-bundle.umd.min.js","simulating-regression-artifact_files/tippy-6.2.7/tippy-light-border.css","simulating-regression-artifact_files/tippy-6.2.7/tippy.css","simulating-regression-artifact_files/tippy-6.2.7/tippy.umd.min.js","simulating-regression-artifact_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Regression Artifact - Re-running Farmus et. al (2019)","description":"A short description of the post.","authors":[{"author":"Marwin Carmo","authorURL":"https://github.com/marwincarmo","affiliation":"University of São Paulo","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-11-04T00:00:00.000-03:00","citationText":"Carmo, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Marwin Carmo</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Blog</a>
<a href="../../about.html">About</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Projects
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://marwin.shinyapps.io/model-selection-app/">Model Selection App</a>
</div>
</div>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="https://github.com/marwincarmo/marwincarmo.github.io" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Regression Artifact - Re-running Farmus et. al (2019)</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:simulation" class="dt-tag">simulation</a>
  <a href="../../index.html#category:regression" class="dt-tag">regression</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>A short description of the post.</p></p>
</div>

<div class="d-byline">
  
  true
  
<br/>2021-11-04
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#lords-paradox-and-the-regression-artifact">Lord’s Paradox and the Regression Artifact</a></li>
<li><a href="#re-running-farmus-et.-al-2019">Re-running Farmus et. al (2019)</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<h2 id="motivation">Motivation</h2>
<p>Recently I came across a publication <span class="citation" data-cites="farmus2019">(<a href="#ref-farmus2019" role="doc-biblioref">Farmus et al., 2019</a>)</span> where the authors outline a statistical artifact that may arise when researchers add continuous predictors correlated with baseline scores as covariates in regression models of pretest-posttest analysis. This effect is known widely as <a href="https://en.wikipedia.org/wiki/Lord%27s_paradox">Lord’s Paradox</a>.</p>
<p>First I’ll briefly cover what is the regression artifact discussed in the first part of the paper. My main goal, however, is to rerun the simulation from part two of their study. This was motivated by the unavailability of the source code as well as an exercise on building a simple simulation study. Replicating simulation studies is a good practice not only to spot potential errors or biases in the results but also to learn and rehearse open research practices <span class="citation" data-cites="lohmann2021">(<a href="#ref-lohmann2021" role="doc-biblioref">Lohmann et al., 2021</a>)</span>.</p>
<p>The code is pretty straightforward and there is nothing too fancy about the methods, but I hope you may learn something from this post that you can apply in your own studies. Having to think about how to translate words and equations into code also made me pause and think with more depth on what I was reading.</p>
<p>I’ll be using R for the simulations. For pedagogical reasons I have opted to work with base R, limiting the use of external packages only to facilitate summarizing results and building plots. I’m saying that because there is the great <a href="https://debruine.github.io/faux/"><code>faux</code> package</a> developed by <a href="https://twitter.com/LisaDeBruine">Lisa DeBruine</a> for simulating factorial designs that could save us many lines of code.</p>
<h2 id="lords-paradox-and-the-regression-artifact">Lord’s Paradox and the Regression Artifact</h2>
<p>Say that we want to test a treatment in two preexisting groups, A and B. Given some prior knowledge about the nature of our hypothetical dependent variable, we have strong basis to suppose that a random subject from group B is higher on average on DV scores than a random subject from group A. Because those groups occur naturally it isn’t possible to perform random assignment of subjects to groups.</p>
<p>We need to specify how we’re going to analyse the data. Given our research design and question there are two potential statistical models to be chosen from <span class="citation" data-cites="farmus2019">(<a href="#ref-farmus2019" role="doc-biblioref">Farmus et al., 2019</a>)</span>:</p>
<p>A change score model (<em>t</em> test)</p>
<span class="math display" id="eq:change">\[\begin{equation}
post_i = \beta_0 + \beta_1group_i + pre_i + e_i
\tag{1}
\end{equation}\]</span>
<p>A regression based model (ANCOVA)</p>
<span class="math display" id="eq:ancova">\[\begin{equation}
post_i = \beta_0 + \beta_1group_i + \beta_2pre_i + e_i
\tag{2}
\end{equation}\]</span>
<p>Here <span class="math inline">\(pre_i\)</span> and <span class="math inline">\(post_i\)</span> are the pretest and posttest scores of subject <span class="math inline">\(i\)</span>. In equation <a href="#eq:change">(1)</a>, <span class="math inline">\(\beta_1\)</span> is the main effect of group (or group mean differences) on gain scores and in equation <a href="#eq:ancova">(2)</a>, it is the partial regression coefficient of <span class="math inline">\(group\)</span> adjusted for pretest scores. The model intercept is <span class="math inline">\(\beta_0\)</span> and the model residuals is represented by <span class="math inline">\(e_i\)</span>.</p>
<p>It should be noted that using <span class="math inline">\(post_i\)</span> or the change score (<span class="math inline">\(post_i - pre_i\)</span>) as the outcome variable yields the same results if <span class="math inline">\(pre_i\)</span> is a covariate in the model <span class="citation" data-cites="senn_2021">(<a href="#ref-senn_2021" role="doc-biblioref">Senn, 2021</a>)</span>.</p>
<p>Though in practice we could choose any of these two models, we may reach different conclusions depending on which one we use. In fact, the choice of the model relies on the questions we’re asking.</p>
<p>The ANCOVA model is preferred when we do not expect baseline differences between groups. This model estimates the difference in post treatment scores controlling for baseline variations <span class="citation" data-cites="walker">(<a href="#ref-walker" role="doc-biblioref">Walker, 2021</a>)</span>. Using pretest scores as covariate when groups are known to be different at baseline is a poor choice because we do not expect the initial differences to disappear when scores are averaged over the group <span class="citation" data-cites="pearl2016">(<a href="#ref-pearl2016" role="doc-biblioref">Pearl, 2016</a>)</span>. As we’ll see shortly, this is exactly why the paradox emerges.</p>
<p>The change score model do not assume that groups are similar at baseline. It tests if groups differ on average on how much they change on the outcome variable from pretest to posttest. The effect of treatment is the difference of pre to post differences between the two groups <span class="citation" data-cites="walker">(<a href="#ref-walker" role="doc-biblioref">Walker, 2021</a>)</span>.</p>
<p>What Lord <span class="citation" data-cites="lord1967">(<a href="#ref-lord1967" role="doc-biblioref">1967</a>)</span> observed is that given a treatment that produces <strong>no effect</strong> on the outcome, a researcher using the ANCOVA model would conclude that, assuming equal baseline scores, one subgroup appears to gain significantly more than the other. A second researcher analyzing the same dataset with the change score model would not reject the null hypothesis that <span class="math inline">\(\beta_1\)</span> = 0.</p>
<p>Though we have used a categorical predictor <span class="math inline">\(group_i\)</span>, the emergence of the paradox is extended to continuous variables. To give rise to the artifact, there needs only to exists some correlation between this predictor and the pretest scores as well as random error in the assessment of change <span class="citation" data-cites="eriksson2014">(<a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström, 2014</a>)</span>. It can happen if, for example, participants are allocated into groups based on scores on some continuous predictor that happens to be associated with the parameter under investigation <span class="citation" data-cites="wright2006">(<a href="#ref-wright2006" role="doc-biblioref">Wright, 2006</a>)</span>.</p>
<p>In most research settings (e.g. psychology), measurement is made with some degree of error. In the persence of random error of measurement, this variance is incorporated in the pre and posttest scores. If we let <span class="math inline">\(U_i\)</span> represent the “true score” (i.e. what we would get if there were no measurement error) of subject <span class="math inline">\(i\)</span>, we have:</p>
<span class="math display" id="eq:pre">\[\begin{equation}
pre_i = U_i^{pre} + e_i^{pre}
\tag{3}
\end{equation}\]</span>
<span class="math display" id="eq:post">\[\begin{equation}
post_i = U_i^{post} + e_i^{post}
\tag{4}
\end{equation}\]</span>
<p>Then, because the expected effect size of treatment is zero, <span class="math inline">\(U_i^{post} - U_i^{pre}\)</span> reflects only the difference between random errors <span class="citation" data-cites="eriksson2014">(<a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström, 2014</a>)</span>.</p>
<p>To keep consistent with the terminology used in <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span>, we use <span class="math inline">\(P_i\)</span> to denote the group variable for the <span class="math inline">\(i^{th}\)</span> subject, where <span class="math inline">\(P_i = 0\)</span> for Group A and <span class="math inline">\(P_i = 1\)</span> for Group B (keep in mind that there is no restriction on <span class="math inline">\(P\)</span> begin solely categorical). Because the “true” pretest scores is estimated from the grouping variable, we have:</p>
<span class="math display" id="eq:true">\[\begin{equation}
U_i = a + bP_i + \epsilon_i
\tag{5}
\end{equation}\]</span>
<p>where <span class="math inline">\(a\)</span> is the model intercept, <span class="math inline">\(b\)</span> the regression coefficient of <span class="math inline">\(P_i\)</span> on <span class="math inline">\(U_i\)</span> and <span class="math inline">\(\epsilon_i\)</span> is the between-individual variation in <span class="math inline">\(U\)</span>.</p>
<p>Lets assume the error term in the measurement of pretest and posttest scores is drawn from a normal distribution with mean 0 and standard deviation, <span class="math inline">\(\sigma\)</span>. Likewise, the error term for the regression of property <span class="math inline">\(P\)</span> on true score <span class="math inline">\(U_i\)</span> is drawn from a normal distribution with mean 0 and standard deviation <span class="math inline">\(s\)</span>.</p>
<p>For a sample of 200 subjects we set, <span class="math inline">\(a\)</span> = 0.5, <span class="math inline">\(b\)</span> = 0.4, <span class="math inline">\(s\)</span> = 0.1, <span class="math inline">\(\sigma\)</span> = 0.1.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>7895</span><span class='op'>)</span> <span class='co'># set seed for reproducibility</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span> <span class='co'># model intercept</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fl'>0.4</span> <span class='co'># regression coefficient</span>
<span class='va'>sigma_error</span> <span class='op'>&lt;-</span> <span class='fl'>.1</span> <span class='co'># pre and posttest error term standard deviation</span>
<span class='va'>var_error</span> <span class='op'>&lt;-</span>  <span class='fl'>.1</span>  <span class='co'># P error term standard deviation</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>200</span> <span class='co'># sample size</span>

<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>, each<span class='op'>=</span><span class='va'>n</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'># group predictor</span>
<span class='va'>U</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>var_error</span><span class='op'>)</span> <span class='co'># true score</span>
<span class='va'>post</span> <span class='op'>&lt;-</span> <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span> <span class='co'># posttest scores</span>
<span class='va'>pre</span> <span class='op'>&lt;-</span> <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span>  <span class='co'># pretest scorers</span>
<span class='va'>change</span> <span class='op'>&lt;-</span> <span class='va'>post</span><span class='op'>-</span><span class='va'>pre</span>                   <span class='co'># change scores</span>

<span class='va'>sim.df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"post"</span> <span class='op'>=</span>  <span class='va'>post</span>, 
                     <span class='st'>"pre"</span> <span class='op'>=</span>  <span class='va'>pre</span>, 
                     <span class='st'>"change"</span> <span class='op'>=</span> <span class='va'>change</span>, 
                     <span class='st'>"group"</span><span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>

<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pre_post</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>sim.df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>post</span>, color<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,size <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>post</span>, color<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,method<span class='op'>=</span><span class='st'>'lm'</span>, 
              se <span class='op'>=</span> <span class='cn'>FALSE</span>, formula<span class='op'>=</span> <span class='va'>y</span><span class='op'>~</span><span class='va'>x</span>, fullrange<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>post</span>, color<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Pretest scores"</span>,
       y <span class='op'>=</span> <span class='st'>"Posttest scores"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Group"</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span><span class='op'>)</span>, 
                     values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#1E88E5"</span>, <span class='st'>"#D81B60"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>post</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>'lm'</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, color <span class='op'>=</span> <span class='st'>"#000000"</span>,
              linetype <span class='op'>=</span> <span class='st'>"dashed"</span>, formula<span class='op'>=</span> <span class='va'>y</span><span class='op'>~</span><span class='va'>x</span>, fullrange<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='cn'>NA</span><span class='op'>)</span>

<span class='va'>pre_change</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>sim.df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>change</span>, color<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,size <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>change</span>, color<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,method<span class='op'>=</span><span class='st'>'lm'</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, formula<span class='op'>=</span> <span class='va'>y</span><span class='op'>~</span><span class='va'>x</span>, fullrange<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>pre</span>, y <span class='op'>=</span> <span class='va'>change</span><span class='op'>)</span>,method<span class='op'>=</span><span class='st'>'lm'</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, formula<span class='op'>=</span> <span class='va'>y</span><span class='op'>~</span><span class='va'>x</span>, fullrange<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>

<span class='va'>pre_post</span>
</code></pre>
</div>
</details>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sim-plot-1"></span>
<img src="simulating-regression-artifact_files/figure-html5/sim-plot-1-1.png" alt="Scatterplot for the average gain from pre to post treatment. Blue line is the slope for group A and the red line is the slope for group B. The black dashed line is the slope for average gain taking both groups together" width="624" data-distill-preview=1 />
<p class="caption">
Figure 1: Scatterplot for the average gain from pre to post treatment. Blue line is the slope for group A and the red line is the slope for group B. The black dashed line is the slope for average gain taking both groups together
</p>
</div>
</div>
<p>So, what do we see? The black dashed line crossing both elipses is close to 45° which means that, taking both groups as a whole, looks like there is no evidence of average differences between groups. In this particular example the slopes for both groups behave as we should often expect when there is no change in scores between two time points. It is visually clear that both are very similar.</p>
<p>Notice that when subjects from groups A and B fall on the same range of pretest scores we see more red dots on the upper half of the plot, suggesting higher posttest scores from subjects in group B. As noted by <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> what is happening is simply an effect of regression to the mean. Because when subjects from group B (higher true score) score low on pretest, they are more likely to do better at posttest. A similar logic applies to high scorers from group A scoring poorer on the followup.</p>
<h3 id="a-mediational-perspective">A mediational perspective</h3>
<p>It can also help to visualize the difference between the two models using diagrams. As shown by <span class="citation" data-cites="pearl2016"><a href="#ref-pearl2016" role="doc-biblioref">Pearl</a> (<a href="#ref-pearl2016" role="doc-biblioref">2016</a>)</span>, we can represent Lord’s paradox as a mediation model,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>"img/dag2.jpg"</span><span class='op'>)</span>
</code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="img/dag2.jpg" alt="Linear version of the model showing pretest scores (Pre) as a mediator between Group (G) and posttest scores (Post). Adapted from @pearl2016" width="50%" />
<p class="caption">
Figure 2: Linear version of the model showing pretest scores (Pre) as a mediator between Group (G) and posttest scores (Post). Adapted from <span class="citation" data-cites="pearl2016"><a href="#ref-pearl2016" role="doc-biblioref">Pearl</a> (<a href="#ref-pearl2016" role="doc-biblioref">2016</a>)</span>
</p>
</div>
</div>
<p>where <strong>G</strong> is the group variable, <strong>Pre</strong> the pretest scores, <strong>Post</strong> the posttest scores and <strong>Y</strong> stands for the difference Post - Pre. What differentiates the ANCOVA and the change score perspectives lies on which effect we wish to estimate. Assuming no confounding, the <em>total effect</em> is estimated as</p>
<span class="math display" id="eq:te">\[\begin{equation}
TE = (b + ac) - a
\tag{6}
\end{equation}\]</span>
<p>Setting <span class="math inline">\(b = a(1-c)\)</span> all paths cancel out each other and we obtain the total effect of 0 observed in our made up experiment.</p>
<p>If we opt for adjusting for pretest scores, the path <span class="math inline">\(ac\)</span> is blocked and only the <em>direct effect</em> is estimated, which is,</p>
<span class="math display" id="eq:de">\[\begin{equation}
DE = b
\tag{7}
\end{equation}\]</span>
<p>Because the direct effect is positive, it becomes clear why the effect for the ANCOVA model is non-zero.</p>
<h3 id="the-regression-artifact">The regression artifact</h3>
<p>The issue raised in <span class="citation" data-cites="farmus2019"><a href="#ref-farmus2019" role="doc-biblioref">Farmus et al.</a> (<a href="#ref-farmus2019" role="doc-biblioref">2019</a>)</span> is that Lord’s Paradox isn’t restricted to categorical predictors. A similar effect can emerge if a continuous predictor of change is correlated with pretest scores and an ANCOVA model is used. Through a literature review, the authors confirm that studies meeting these conditions are not uncommon among papers published in top psychology journals.</p>
<p>For simplicity I’ll not bother to show the mathematical derivation of the regression artifact here but the interested reader can refer to <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> or <span class="citation" data-cites="kim2018"><a href="#ref-kim2018" role="doc-biblioref">Kim</a> (<a href="#ref-kim2018" role="doc-biblioref">2018</a>)</span>. What we need to have in mind is that the regression artifact is the coefficient <span class="math inline">\(\beta_1\)</span> from equation <a href="#eq:ancova">(2)</a>. Using <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> notation, the estimate for the regression artifact is expressed as:</p>
<span class="math display" id="eq:regart">\[\begin{equation}
\hat{K} = \frac{b\sigma^2}{(s^2+\sigma^2)}
\tag{8}
\end{equation}\]</span>
<p>If we input the parameters set to build figure <a href="#fig:sim-plot-1">1</a> and calculate the value of <span class="math inline">\(K\)</span>, assuming infinite samples, <span class="math inline">\(K\)</span> = 0.2.</p>
<p>Surprisingly, re-running <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> simulation of the regression artifact, we get a different estimate for its standard deviation.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>7895</span><span class='op'>)</span>

<span class='va'>K</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>reps</span> <span class='op'>&lt;-</span> <span class='fl'>10000</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fl'>0.4</span>
<span class='va'>sigma_error</span> <span class='op'>&lt;-</span> <span class='fl'>.1</span>
<span class='va'>var_error</span> <span class='op'>&lt;-</span>  <span class='fl'>.1</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>105</span>

<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='va'>n</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>U</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>var_error</span><span class='op'>)</span>
<span class='va'>post</span> <span class='op'>&lt;-</span> <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span>
<span class='va'>pre</span> <span class='op'>&lt;-</span> <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span>
<span class='va'>change</span> <span class='op'>&lt;-</span> <span class='va'>post</span><span class='op'>-</span><span class='va'>pre</span>

<span class='va'>sim.df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"post"</span> <span class='op'>=</span>  <span class='va'>post</span>, 
                     <span class='st'>"pre"</span> <span class='op'>=</span>  <span class='va'>pre</span>, 
                     <span class='st'>"change"</span> <span class='op'>=</span> <span class='va'>change</span>, 
                     <span class='st'>"group"</span><span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>change</span> <span class='op'>~</span> <span class='va'>pre</span> <span class='op'>+</span> <span class='va'>group</span>, data <span class='op'>=</span> <span class='va'>sim.df</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>K</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='va'>k_mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>K</span><span class='op'>)</span>
<span class='va'>k_sd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>K</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/enframe.html'>enframe</a></span><span class='op'>(</span><span class='va'>K</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='st'>"lightblue1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>latex2exp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/latex2exp/man/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>"Coefficient for $\\hat{K}$"</span><span class='op'>)</span>,
       y <span class='op'>=</span> <span class='st'>"Frequency"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:hist-K"></span>
<img src="simulating-regression-artifact_files/figure-html5/hist-K-1.png" alt="Distribution of the coefficients for predictor $P$ on the change score" width="624" />
<p class="caption">
Figure 3: Distribution of the coefficients for predictor <span class="math inline">\(P\)</span> on the change score
</p>
</div>
</div>
<p>As expected, the mean value for <span class="math inline">\(\hat{K}\)</span> is 0.2. Our estimate for the standard deviation of <span class="math inline">\(\hat{K}\)</span> is 0.04, close to half the value <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> reported. In their study, they have found 98% of <span class="math inline">\(\hat{K}\)</span> values greater than zero. In 10,000 simulated datasets, we found the frequency of <span class="math inline">\(\hat{K}\)</span> &gt; 0 to be 100%<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<h2 id="re-running-farmus-et.-al-2019">Re-running Farmus et. al (2019)</h2>
<p>We now return to <span class="citation" data-cites="farmus2019"><a href="#ref-farmus2019" role="doc-biblioref">Farmus et al.</a> (<a href="#ref-farmus2019" role="doc-biblioref">2019</a>)</span> study. Including the baseline scores as covariate in a pretest to posttest change model may lead us to falsely conclude a significant association if a non-negligible correlation exists between the predictor and the covariate. The authors use Monte Carlo simulations to estimate Type I error rate in scenarios like the one described, varying the size of <span class="math inline">\(b\)</span> (equation <a href="#eq:true">(5)</a>), and the sample size.</p>
<p>Other parameters were fixed such that the standard deviation of <span class="math inline">\(e_i^{pre}\)</span>, <span class="math inline">\(e_i^{post}\)</span>, and <span class="math inline">\(\epsilon_i\)</span> were set to 1. The variance of <span class="math inline">\(P\)</span> (<span class="math inline">\(\sigma^2_P\)</span>) was also set to 1. Both <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(a\)</span> were set to 0. Coefficient <span class="math inline">\(b\)</span> ranged from -1 to 1 by 0.5 steps and sample sizes of 20, 50, 100, and 1,000 were used. To keep every condition exact as the original study, 5,000 simulations were run for each pair and the statistical significance level set at 0.05.</p>
<p>The simulation will only estimate the Type I error rates because the size of parameters like the regression artifact (<span class="math inline">\(K\)</span>) and the correlation between the pretest scores and true score (<span class="math inline">\(\rho(pre,P)\)</span>) can be estimated from the parameters values fixed previously.</p>
<p>Looking at equations <a href="#eq:pre">(3)</a> and <a href="#eq:true">(5)</a> we know that,</p>
<span class="math display" id="eq:pre2">\[\begin{equation}
pre_i = a + bP_i + \epsilon_i + e_i^{pre}
\tag{9}
\end{equation}\]</span>
<p>then calculating <span class="math inline">\(\rho_{(pre,P)}\)</span> becomes straightforward</p>
<span class="math display" id="eq:rho">\[\begin{align}
\begin{split}
  \rho_{pre,P} &amp; = \frac{\mathrm{Cov}(pre, P)}{\sigma_{pre}\sigma_{P}}\\
  &amp; = \frac{b\sigma^2_P}{(\sqrt{b^2\sigma^2_P + s^2 + \sigma^2}) + \sigma^2_P}
\end{split}
  \tag{10}
\end{align}\]</span>
<p>Our first step is to create a function that takes as arguments the number of runs, sample size and the population value of coefficient <span class="math inline">\(b\)</span>. We can store the <em>p</em>-value of each analysis and count afterwards how many were less than the the alpha level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim.reg.artifact</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>n.sims</span>, <span class='va'>sample.size</span>, <span class='va'>beta</span><span class='op'>)</span> <span class='op'>{</span>

  <span class='va'>reps</span> <span class='op'>&lt;-</span> <span class='va'>n.sims</span>
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>sample.size</span>
  <span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='va'>beta</span>
  <span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>X.sd</span> <span class='op'>&lt;-</span> <span class='va'>sigma_error</span> <span class='op'>&lt;-</span> <span class='va'>var_error</span> <span class='op'>&lt;-</span>  <span class='fl'>1</span>
  <span class='va'>pval</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>beta</span><span class='op'>*</span><span class='op'>(</span><span class='va'>X.sd</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>beta</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='op'>(</span><span class='va'>X.sd</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>sigma_error</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>var_error</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>K</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>beta</span><span class='op'>*</span><span class='va'>sigma_error</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>sigma_error</span> <span class='op'>+</span> <span class='va'>var_error</span><span class='op'>)</span> <span class='co'># the regression artifact</span>

  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>

    <span class='va'>P</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># Property P from equation 5</span>
    <span class='va'>U</span> <span class='op'>&lt;-</span> <span class='va'>b0</span> <span class='op'>+</span> <span class='va'>beta</span><span class='op'>*</span><span class='va'>P</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>var_error</span><span class='op'>)</span> <span class='co'># The "true score" from equation 5</span>

    <span class='va'>pre</span> <span class='op'>&lt;-</span> <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span> <span class='co'># Pretest scores - equation 3</span>
    <span class='va'>post</span> <span class='op'>&lt;-</span>  <span class='va'>U</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span> <span class='co'># Posttest scores - equation 4</span>

    <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>P</span>, <span class='va'>pre</span>, <span class='va'>post</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># A dataframe with outcome and predictors</span>
    <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"P"</span>, <span class='st'>"pre"</span>, <span class='st'>"post"</span><span class='op'>)</span>
    
    <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>post</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
    <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
    <span class='va'>pval</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span> <span class='co'># p-value for the coefficient of P</span>

  <span class='op'>}</span>
  
  <span class='co'># store the simulated results in a data frame for display</span>
  <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    sample_size <span class='op'>=</span> <span class='va'>n</span>,
    bx <span class='op'>=</span> <span class='va'>beta</span>,
    correlation <span class='op'>=</span> <span class='va'>r</span>,
    artifact <span class='op'>=</span> <span class='va'>K</span>,
    error_rate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>pval</span><span class='op'>)</span>
  <span class='op'>)</span>

  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Nesting for loops can easily become confusing, so I have opted to use the <code>purrr::map_dfr()</code> function, which I find to be a simpler and more elegant solution.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>finaltable</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dfr</a></span><span class='op'>(</span><span class='va'>samplesize</span>,
                             <span class='op'>~</span><span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>map2</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='va'>coefs</span>,
                                          <span class='op'>~</span><span class='fu'>sim.reg.artifact</span><span class='op'>(</span><span class='fl'>5000</span>, <span class='va'>.x</span>, <span class='va'>.y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>finaltable</span> |&gt; 
  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>sample_size</span>, values_from <span class='op'>=</span> <span class='va'>error_rate</span><span class='op'>)</span> |&gt;
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kbl.html'>kbl</a></span><span class='op'>(</span>
    col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"$b_x$"</span>, <span class='st'>"$\\rho(pre,P)$"</span>, <span class='st'>"Artifact"</span>, <span class='st'>"N = 20"</span>,
                  <span class='st'>"N = 50"</span>, <span class='st'>"N = 100"</span>, <span class='st'>"N = 1,000"</span><span class='op'>)</span>,
    digits <span class='op'>=</span> <span class='fl'>3</span>,
    align <span class='op'>=</span> <span class='st'>'c'</span>
  <span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>bootstrap_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"striped"</span>, <span class='st'>"hover"</span>, <span class='st'>"condensed"</span>, <span class='st'>"responsive"</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/add_header_above.html'>add_header_above</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>" "</span> <span class='op'>=</span> <span class='fl'>3</span>, <span class='st'>"Type I error rate"</span> <span class='op'>=</span> <span class='fl'>4</span> <span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Type I error rate
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
<span class="math inline">\(b_x\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\rho(pre,P)\)</span>
</th>
<th style="text-align:center;">
Artifact
</th>
<th style="text-align:center;">
N = 20
</th>
<th style="text-align:center;">
N = 50
</th>
<th style="text-align:center;">
N = 100
</th>
<th style="text-align:center;">
N = 1,000
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
-1.0
</td>
<td style="text-align:center;">
-0.577
</td>
<td style="text-align:center;">
-0.50
</td>
<td style="text-align:center;">
0.267
</td>
<td style="text-align:center;">
0.612
</td>
<td style="text-align:center;">
0.900
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:center;">
-0.5
</td>
<td style="text-align:center;">
-0.333
</td>
<td style="text-align:center;">
-0.25
</td>
<td style="text-align:center;">
0.131
</td>
<td style="text-align:center;">
0.258
</td>
<td style="text-align:center;">
0.471
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.000
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.051
</td>
<td style="text-align:center;">
0.051
</td>
<td style="text-align:center;">
0.048
</td>
<td style="text-align:center;">
0.052
</td>
</tr>
<tr>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.333
</td>
<td style="text-align:center;">
0.25
</td>
<td style="text-align:center;">
0.120
</td>
<td style="text-align:center;">
0.259
</td>
<td style="text-align:center;">
0.475
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
<tr>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
0.577
</td>
<td style="text-align:center;">
0.50
</td>
<td style="text-align:center;">
0.263
</td>
<td style="text-align:center;">
0.618
</td>
<td style="text-align:center;">
0.895
</td>
<td style="text-align:center;">
1.000
</td>
</tr>
</tbody>
</table>
</div>
<p>Great! Our results match pretty closely those reported by <span class="citation" data-cites="farmus2019"><a href="#ref-farmus2019" role="doc-biblioref">Farmus et al.</a> (<a href="#ref-farmus2019" role="doc-biblioref">2019</a>)</span>. Notice that in a world where <span class="math inline">\(\rho_{(pre,P)}\)</span> is zero, in the long run the Type I error rate stay within range of what was expected.</p>
<p>To wrap up, we can use the function just created to also reproduce the simulations <span class="citation" data-cites="farmus2019"><a href="#ref-farmus2019" role="doc-biblioref">Farmus et al.</a> (<a href="#ref-farmus2019" role="doc-biblioref">2019</a>)</span> ran using median parameter values discovered in their literature review of experimental psychology studies.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim2</span> <span class='op'>&lt;-</span> <span class='fu'>sim.reg.artifact</span><span class='op'>(</span>n.sims <span class='op'>=</span> <span class='fl'>5000</span>, sample.size <span class='op'>=</span> <span class='fl'>239</span>, beta <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span>

<span class='va'>sim2</span> |&gt; 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kbl.html'>kbl</a></span><span class='op'>(</span>
    col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sample size"</span>, <span class='st'>"$b_x$"</span>, <span class='st'>"$\\rho(pre,P)$"</span>, <span class='st'>"Artifact"</span>, <span class='st'>"Type I error rate"</span><span class='op'>)</span>,
    digits <span class='op'>=</span> <span class='fl'>3</span>,
    align <span class='op'>=</span> <span class='st'>'c'</span>
  <span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>bootstrap_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"striped"</span>, <span class='st'>"hover"</span>, <span class='st'>"condensed"</span>, <span class='st'>"responsive"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Sample size
</th>
<th style="text-align:center;">
<span class="math inline">\(b_x\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\rho(pre,P)\)</span>
</th>
<th style="text-align:center;">
Artifact
</th>
<th style="text-align:center;">
Type I error rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
239
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.272
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.674
</td>
</tr>
</tbody>
</table>
</div>
<p>Again we have a match of results with the original study. What makes those results alarming is the Type I error rate of 0.67! As the authors emphasize, common conditions in psychological research may elicit unacceptably high error rates which researchers may not be aware of if an inappropriate model is employed.</p>
<h2 id="conclusion">Conclusion</h2>
<p>We have covered a definition of Lord’s Paradox and argued that choosing a model that does not fit the research question can lead to biased conclusions. As <span class="citation" data-cites="farmus2019"><a href="#ref-farmus2019" role="doc-biblioref">Farmus et al.</a> (<a href="#ref-farmus2019" role="doc-biblioref">2019</a>)</span> outline, correlation between the predictor and the outcome and some amount of measurement error are necessary conditions for the emergence of a regression artifact. It is important that researchers take this into consideration before drawing conclusions about the data.</p>
<p>Following recent calls to reproduce simulation studies <span class="citation" data-cites="lohmann2021">(<a href="#ref-lohmann2021" role="doc-biblioref">Lohmann et al., 2021</a>)</span> we have worked to reproduce simulations performed by two papers discussing Lord’s Paradox with continuous predictors. Monte Carlo simulations are not needed to demonstrate the regression artifact and no major recommendations are being proposed by the original studies based on the simulation results. Even so, a minor discrepancy from <span class="citation" data-cites="eriksson2014"><a href="#ref-eriksson2014" role="doc-biblioref">Eriksson &amp; Häggström</a> (<a href="#ref-eriksson2014" role="doc-biblioref">2014</a>)</span> was found, highlighting that computer code is not error free. Reproducing simulation analysis proved to be fruitful not only in finding divergent results but also as a coding exercise.</p>
<p>Lord’s Paradox have been and continues to be widely debated in the quantitative methods literature. Many of the papers referenced in the text broaden the discussion investigating this topic in different and more complex scenarios. Hopefully this post has reached its instructive purpose of teaching a few things about simulating data in R. If you have any comments or questions, feel free to reach me via email or twitter.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-eriksson2014" class="csl-entry" role="doc-biblioentry">
Eriksson, K., &amp; Häggström, O. (2014). Lord’s <span>Paradox</span> in a <span>Continuous Setting</span> and a <span>Regression Artifact</span> in <span>Numerical Cognition Research</span>. <em>PLOS ONE</em>, <em>9</em>(4), e95949. <a href="https://doi.org/f2z5hc">https://doi.org/f2z5hc</a>
</div>
<div id="ref-farmus2019" class="csl-entry" role="doc-biblioentry">
Farmus, L., Arpin-Cribbie, C. A., &amp; Cribbie, R. A. (2019). Continuous predictors of pretest-posttest change: Highlighting the impact of the regression artifact. <em>Frontiers in Applied Mathematics and Statistics</em>, <em>4</em>, 64. <a href="https://doi.org/gk92gx">https://doi.org/gk92gx</a>
</div>
<div id="ref-kim2018" class="csl-entry" role="doc-biblioentry">
Kim, S. B. (2018). Explaining lord’s paradox in introductory statistical theory courses. <em>International Journal of Statistics and Probability</em>, <em>7</em>(4), 1. <a href="https://doi.org/10.5539/ijsp.v7n4p1">https://doi.org/10.5539/ijsp.v7n4p1</a>
</div>
<div id="ref-lohmann2021" class="csl-entry" role="doc-biblioentry">
Lohmann, A., Astivia, O. L. O., Morris, T., &amp; Groenwold, R. H. H. (2021). <em>It’s time! 10 + 1 reasons we should start replicating simulation studies</em>. <a href="https://doi.org/10.31234/osf.io/agsnt">https://doi.org/10.31234/osf.io/agsnt</a>
</div>
<div id="ref-lord1967" class="csl-entry" role="doc-biblioentry">
Lord, F. M. (1967). A paradox in the interpretation of group comparisons. <em>Psychological Bulletin</em>, <em>68</em>(5), 304–305. <a href="https://doi.org/10.1037/h0025105">https://doi.org/10.1037/h0025105</a>
</div>
<div id="ref-pearl2016" class="csl-entry" role="doc-biblioentry">
Pearl, J. (2016). Lord<span>’</span>s Paradox Revisited <span><span></span></span> (Oh Lord! Kumbaya!). <em>Journal of Causal Inference</em>, <em>4</em>(2). <a href="https://doi.org/10.1515/jci-2016-0021">https://doi.org/10.1515/jci-2016-0021</a>
</div>
<div id="ref-senn_2021" class="csl-entry" role="doc-biblioentry">
Senn, S. (2021). Cause for concern. In <em>LinkedIn</em>. LinkedIn. <a href="https://www.linkedin.com/pulse/cause-concern-stephen-senn/">https://www.linkedin.com/pulse/cause-concern-stephen-senn/</a>
</div>
<div id="ref-walker" class="csl-entry" role="doc-biblioentry">
Walker, J. A. (2021). Models for longitudinal experiments – pre-post designs. In <em>Elements of statistical modeling for experimental biology</em>. <a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/models-for-longitudinal-experiments-pre-post-designs.html">https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/models-for-longitudinal-experiments-pre-post-designs.html</a>
</div>
<div id="ref-wright2006" class="csl-entry" role="doc-biblioentry">
Wright, D. B. (2006). Comparing groups in a before-after design: When t test and ANCOVA produce different results. <em>British Journal of Educational Psychology</em>, <em>76</em>(3), 663–675. <a href="https://doi.org/10.1348/000709905x52210">https://doi.org/10.1348/000709905x52210</a>
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>I’m not excluding the possibility that it may have been me that got it wrong. If this is the case and you identify where I screwed up, please let me know!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2021-11-04-simulating-regression-artifact/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Regression%20Artifact%20-%20Re-running%20Farmus%20et.%20al%20%282019%29&amp;url=https%3A%2F%2Fmarwincarmo.github.io%2Fposts%2F2021-11-04-simulating-regression-artifact%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fmarwincarmo.github.io%2Fposts%2F2021-11-04-simulating-regression-artifact%2F&amp;title=Regression%20Artifact%20-%20Re-running%20Farmus%20et.%20al%20%282019%29">
        <i class="fab fa-linkedin"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://marwincarmo.github.io.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/';
  this.page.identifier = 'posts/2021-11-04-simulating-regression-artifact/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://marwincarmo.github.io.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/marwincarmo/marwincarmo.github.io/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/marwincarmo/marwincarmo.github.io">https://github.com/marwincarmo/marwincarmo.github.io</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Carmo (2021, Nov. 4). Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019). Retrieved from https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{carmo2021regression,
  author = {Carmo, Marwin},
  title = {Marwin Carmo: Regression Artifact - Re-running Farmus et. al (2019)},
  url = {https://marwincarmo.github.io/posts/2021-11-04-simulating-regression-artifact/},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
