<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Marwin Carmo: Simulating post selection inference</title>

<meta property="description" itemprop="description" content=""/>

<link rel="canonical" href="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-04-07"/>
<meta property="article:created" itemprop="dateCreated" content="2022-04-07"/>
<meta name="article:author" content="Marwin Carmo"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Marwin Carmo: Simulating post selection inference"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:url" content="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"/>
<meta property="og:image" content="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/model-selection-bias_files/figure-html5/predinc-1.png"/>
<meta property="og:image:width" content="3900"/>
<meta property="og:image:height" content="2400"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Marwin Carmo"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Marwin Carmo: Simulating post selection inference"/>
<meta property="twitter:description" content=""/>
<meta property="twitter:url" content="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"/>
<meta property="twitter:image" content="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/model-selection-bias_files/figure-html5/predinc-1.png"/>
<meta property="twitter:image:width" content="3900"/>
<meta property="twitter:image:height" content="2400"/>
<meta property="twitter:site" content="@marwincarmo"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Marwin Carmo: Simulating post selection inference"/>
<meta name="citation_fulltext_html_url" content="https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2022/04/07"/>
<meta name="citation_publication_date" content="2022/04/07"/>
<meta name="citation_author" content="Marwin Carmo"/>
<meta name="citation_author_institution" content="University of São Paulo"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Statistical Inference After Model Selection;citation_publication_date=2010;citation_volume=26;citation_doi=10.1007/s10940-009-9077-7;citation_issn=1573-7799;citation_author=Richard Berk;citation_author=Lawrence Brown;citation_author=Linda Zhao"/>
  <meta name="citation_reference" content="citation_title=What you can and can’t properly do with regression;citation_publication_date=2010;citation_volume=26;citation_doi=10.1007/s10940-010-9116-4;citation_issn=1573-7799;citation_author=Richard Berk"/>
  <meta name="citation_reference" content="citation_title=Statistical methods for the social and behavioural sciences: A model-based approach;citation_publication_date=2017;citation_publisher=SAGE Publications;citation_author=D. B. Flora"/>
  <meta name="citation_reference" content="citation_title=Valid post-selection inference;citation_publication_date=2013;citation_publisher=Institute of Mathematical Statistics;citation_volume=41;citation_doi=10.1214/12-AOS1077;citation_issn=0090-5364, 2168-8966;citation_author=Richard Berk;citation_author=Lawrence Brown;citation_author=Andreas Buja;citation_author=Kai Zhang;citation_author=Linda Zhao"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","creative_commons","bibliography","csl","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Simulating post selection inference"]},{"type":"character","attributes":{},"value":[""]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["first_name","last_name","url","affiliation","affilitation_url"]}},"value":[{"type":"character","attributes":{},"value":["Marwin"]},{"type":"character","attributes":{},"value":["Carmo"]},{"type":"character","attributes":{},"value":["https://github.com/marwincarmo"]},{"type":"character","attributes":{},"value":["University of São Paulo"]},{"type":"character","attributes":{},"value":["https://www3.fm.usp.br/en/portal/"]}]}]},{"type":"character","attributes":{},"value":["2022-04-07"]},{"type":"character","attributes":{},"value":["simulation","regression","bias","model selection"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","highlight","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["rstudio"]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["references.bib"]},{"type":"character","attributes":{},"value":["apa.csl"]},{"type":"character","attributes":{},"value":["https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"]},{"type":"character","attributes":{},"value":["https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["apa.csl","model-selection-bias_files/anchor-4.2.2/anchor.min.js","model-selection-bias_files/bowser-1.9.3/bowser.min.js","model-selection-bias_files/core-js-2.5.3/LICENSE","model-selection-bias_files/core-js-2.5.3/package.json","model-selection-bias_files/core-js-2.5.3/shim.min.js","model-selection-bias_files/distill-2.2.21/template.v2.js","model-selection-bias_files/figure-html5/fig3-1.png","model-selection-bias_files/figure-html5/fig3-2.png","model-selection-bias_files/figure-html5/fig4-1.png","model-selection-bias_files/figure-html5/fig4-2.png","model-selection-bias_files/figure-html5/figures-side-1.png","model-selection-bias_files/figure-html5/figures-side-2.png","model-selection-bias_files/figure-html5/plot-ex1-1.png","model-selection-bias_files/figure-html5/plot-ex1a-1.png","model-selection-bias_files/figure-html5/plot-ex1b-1.png","model-selection-bias_files/figure-html5/predinc-1.png","model-selection-bias_files/figure-html5/prefcond-1.png","model-selection-bias_files/figure-html5/simplots-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-1-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-2-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-3-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-4-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-5-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-6-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-7-1.png","model-selection-bias_files/figure-html5/unnamed-chunk-8-1.png","model-selection-bias_files/header-attrs-2.12/header-attrs.js","model-selection-bias_files/header-attrs-2.13/header-attrs.js","model-selection-bias_files/htmlwidgets-1.5.4/htmlwidgets.js","model-selection-bias_files/jquery-3.6.0/jquery-3.6.0.js","model-selection-bias_files/jquery-3.6.0/jquery-3.6.0.min.js","model-selection-bias_files/jquery-3.6.0/jquery-3.6.0.min.map","model-selection-bias_files/kePrint-0.0.1/kePrint.js","model-selection-bias_files/lightable-0.0.1/lightable.css","model-selection-bias_files/popper-2.6.0/popper.min.js","model-selection-bias_files/react-17.0.0/AUTHORS","model-selection-bias_files/react-17.0.0/LICENSE.txt","model-selection-bias_files/react-17.0.0/react-dom.min.js","model-selection-bias_files/react-17.0.0/react.min.js","model-selection-bias_files/reactable-binding-0.2.3/reactable.js","model-selection-bias_files/reactwidget-1.0.0/react-tools.js","model-selection-bias_files/reactwidget-1.0.0/react-tools.js.map","model-selection-bias_files/tippy-6.2.7/tippy-bundle.umd.min.js","model-selection-bias_files/tippy-6.2.7/tippy-light-border.css","model-selection-bias_files/tippy-6.2.7/tippy.css","model-selection-bias_files/tippy-6.2.7/tippy.umd.min.js","model-selection-bias_files/webcomponents-2.0.0/webcomponents.js","references.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       "Helvetica Neue";
  --navbar-font:     "Droid Sans";  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
}


/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
  --font-weight:      300;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

/*
For project cards
Adapted from Ijeamaka Anyene
https://github.com/Ijeamakaanyene/ijeamaka-anyene
https://ijeamaka-anyene.netlify.app
*/

.card {
    color: #474747;
    background-color: #FFFFFF;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    transition: 0.3s;
    border-radius: 10px;
    margin: 16px 16px;
    text-decoration: none;
    display: flex;
}

.card-body {
  padding: 2px 16px;
}

.card-img {
  padding-top: 10px;
  padding-right: 10px;
  padding-bottom: 5px;
  border-radius: 30px;
}

.card-footer {
  background-color: #000;
  color: white;
  text-align: right;
  padding-right: 5px;
}


@media screen and (max-width: 992px) {
  .card {
    color: #474747;
    background-color: #FFFFFF;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    transition: 0.3s;
    border-radius: 10px;
    margin: 16px 16px;
    text-decoration: none;
    display: block;
    width: 300px;
  }

}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
  <script src="../../site_libs/react-17.0.0/react.min.js"></script>
  <script src="../../site_libs/react-17.0.0/react-dom.min.js"></script>
  <script src="../../site_libs/reactwidget-1.0.0/react-tools.js"></script>
  <script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="../../site_libs/reactable-binding-0.2.3/reactable.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (!/posts/.test(location.pathname)) {
      return;
    }

    var script = document.createElement("script");
    script.src = "https://utteranc.es/client.js";
    script.setAttribute("repo", "etiennebacher/personal_website_distill");
    script.setAttribute("issue-term", "og:title");
    script.setAttribute("crossorigin", "anonymous");
    script.setAttribute("label", "comment_thread");

    /* wait for article to load, append script to article element */
    var observer = new MutationObserver(function (mutations, observer) {
      var article = document.querySelector("d-article");
      if (article) {
        observer.disconnect();
        /* HACK: article scroll */
        article.setAttribute("style", "overflow-y: hidden");
        article.appendChild(script);
      }
    });

    observer.observe(document.body, { childList: true });
  });
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-F6HLBQTD1Q"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-F6HLBQTD1Q');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Simulating post selection inference","description":"","authors":[{"author":"Marwin Carmo","authorURL":"https://github.com/marwincarmo","affiliation":"University of São Paulo","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-07T00:00:00.000-03:00","citationText":"Carmo, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Marwin Carmo</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">About</a>
<a href="../../cv/cv-compact-v2.pdf">CV</a>
<a href="../../blog.html">Blog</a>
<a href="../../projects.html">Projects</a>
<a href="https://twitter.com/marwincarmo">
<i class="fab fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://github.com/marwincarmo/marwincarmo.github.io" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Simulating post selection inference</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../blog.html#category:simulation" class="dt-tag">simulation</a>
  <a href="../../blog.html#category:regression" class="dt-tag">regression</a>
  <a href="../../blog.html#category:bias" class="dt-tag">bias</a>
  <a href="../../blog.html#category:model_selection" class="dt-tag">model selection</a>
</div>
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  true
  
<br/>2022-04-07
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#what-is-model-selection">What is model selection</a></li>
<li><a href="#why-is-it-a-problem">Why is it a problem?</a>
<ul>
<li><a href="#illustration">Illustration</a></li>
</ul></li>
<li><a href="#other-issues">Other issues</a>
<ul>
<li><a href="#noise">Noise</a></li>
<li><a href="#sample-size">Sample size</a></li>
<li><a href="#candidate-predictors">Candidate predictors</a></li>
</ul></li>
<li><a href="#visualizing-distributions">Visualizing
distributions</a></li>
<li><a href="#conclusion">Conclusion</a>
<ul>
<li><a href="#acknowledgments">Acknowledgments</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="what-is-model-selection">What is model selection</h1>
<p>Much of the current research questions on behavioral and social
sciences are investigated using statistical models <span
class="citation" data-cites="flora2017statistical">(<a
href="#ref-flora2017statistical" role="doc-biblioref">Flora,
2017</a>)</span>. Models are simplified translations of a reality to
mathematical expressions; its’ aim is to express how data were
generated. Regression-based models are vastly employed in empirical
research and often used to estimate causal effects <span
class="citation" data-cites="berk2010">(<a href="#ref-berk2010"
role="doc-biblioref">Berk, 2010</a>)</span>. However, to perform causal
modeling, researchers must specify a “correct” model (i.e., an accurate
model of the data generating process) prior to data collection and use
the obtained data only to estimate regression coefficients (see <span
class="citation" data-cites="berk2010">Berk (<a href="#ref-berk2010"
role="doc-biblioref">2010</a>)</span> for further discussion). In
practice, researchers usually only have a vague idea of the right model
to answer their research questions, or even if such model can be
estimated. Often, what is framed as statistical inference or causal
modeling is in fact a descriptive analysis; what <span class="citation"
data-cites="berk2010">Berk (<a href="#ref-berk2010"
role="doc-biblioref">2010</a>)</span> name as <em>Level I Regression
Analysis</em>.</p>
<p>To determine which variables should be included in the model, a
common solution is to resort to variable selection algorithms. The
drawback is that whenever data-driven variable selection procedures are
employed, classical inference guarantees are invalidated due to the
model itself becoming <a
href="https://en.wikipedia.org/wiki/Stochastic">stochastic</a> <span
class="citation" data-cites="berkValidPostselectionInference2013">(<a
href="#ref-berkValidPostselectionInference2013"
role="doc-biblioref">Berk et al., 2013</a>)</span>. It means that if the
model selection method evaluates the stochastic component of the data,
the model is also considered stochastic.</p>
<h1 id="why-is-it-a-problem">Why is it a problem?</h1>
<p>Variable selection procedures aren’t in themselves problematic.
Nevertheless, when the correct model is unknown prior to data analysis,
and the <em>same</em> dataset is used for I) variable selection, II)
parameter estimation, and III) statistical inferences, the estimated
results can be highly biased. This is because we add a new source of
uncertainty when performing model selection. These procedures discards
parameter estimates from the model, and, as we shall see, the sampling
distribution of the remaining regression parameters estimates gets
distorted. In addition, the selected model isn’t the same across
samples, so there is another source of uncertainty to the estimates.
<span class="citation"
data-cites="berkStatisticalInferenceModel2010">(<a
href="#ref-berkStatisticalInferenceModel2010" role="doc-biblioref">Berk
et al., 2010</a>)</span>.</p>
<p>Consider a well defined population with its unknown regression
parameter values. We draw a random sample and apply a model selection
procedure. The “best” model found by the variable selection is sample
specific and isn’t guarantee to be the correct model (if we assume that
such model in fact exists). Suppose we repeat the process of drawing a
random sample and performing model selection 10,000 times. In this
example there are six possible candidates, and only one correct model.
We can simulate the expected frequency in which each of these models is
chosen given a probability of 1/3 for the correct model and 1/9
otherwise. As shown in the following table, even if the correct model
(in this case, <span class="math inline">\(\hat{M}_2\)</span>) is three
times more likely to be selected than the competing models, it is
expected to be chosen more frequently but not at the majority of the
time. Therefore, the expected selected model is an incorrect one.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>models</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"M"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span>

<span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/enframe.html'>enframe</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span>
      <span class='va'>models</span>, <span class='fl'>10000</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span>, 
      prob <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>9</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>9</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>9</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>9</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>10000</span>,
  name <span class='op'>=</span> <span class='st'>"Model"</span>, value <span class='op'>=</span> <span class='st'>"Frequency"</span><span class='op'>)</span> |&gt; 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M1</td>
<td style="text-align: right;">0.1225</td>
</tr>
<tr class="even">
<td style="text-align: left;">M2</td>
<td style="text-align: right;">0.3786</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M3</td>
<td style="text-align: right;">0.1237</td>
</tr>
<tr class="even">
<td style="text-align: left;">M4</td>
<td style="text-align: right;">0.1237</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M5</td>
<td style="text-align: right;">0.1263</td>
</tr>
<tr class="even">
<td style="text-align: left;">M6</td>
<td style="text-align: right;">0.1252</td>
</tr>
</tbody>
</table>
</div>
<p>To understand why the regression parameters estimates might be
biased, recall that in a multiple regression we estimate <em>partial
regression coefficients</em>: in a regression equation, the weight of
independent variables are estimated <strong>in relation to</strong> the
other independent variables in the model <span class="citation"
data-cites="cohen1983">(<a href="#ref-cohen1983"
role="doc-biblioref">Cohen &amp; Cohen, 1983</a>)</span>. For a
dependent variable, <span class="math inline">\(Y\)</span>, predicted by
variables <span class="math inline">\(X_1\)</span> and <span
class="math inline">\(X_2\)</span>, <span class="math inline">\(B_{Y1
\cdot 2}\)</span> is the partial regression coefficient for <span
class="math inline">\(Y\)</span> on <span
class="math inline">\(X_1\)</span> holding <span
class="math inline">\(X_2\)</span> constant, and <span
class="math inline">\(B_{Y2 \cdot 1}\)</span> is the partial regression
coefficient for <span class="math inline">\(Y\)</span> on <span
class="math inline">\(X_2\)</span> holding <span
class="math inline">\(X_1\)</span> constant. This regression equation is
written as:</p>
<p><span class="math display" id="eq:multreg">\[\begin{equation}
\hat{Y} = B_{Y0 \cdot 12} + B_{Y1 \cdot 2}X_1 + B_{Y2 \cdot 1}X_2 +
\varepsilon
\tag{1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(B_{Y0 \cdot 12}\)</span> is the
model intercept when <span class="math inline">\(X_1\)</span> and <span
class="math inline">\(X_2\)</span> are held constant and <span
class="math inline">\(\varepsilon\)</span> is the error term.</p>
<p>The regression coefficient for <span
class="math inline">\(X_i\)</span>, for <span class="math inline">\(i =
\{1, 2\}\)</span>, is model dependent. To see why, let’s take a look at
the equations for the regression coefficients for <span
class="math inline">\(X_1\)</span> (<span class="math inline">\(B_{Y1
\cdot 2}\)</span>) and <span class="math inline">\(X_2\)</span> (<span
class="math inline">\(B_{Y2 \cdot 1}\)</span>)</p>
<p><span class="math display" id="eq:beta12">\[\begin{equation}
B_{Y1 \cdot 2} = \frac{\rho_{Y1} - \rho_{Y2}\rho_{12}}{(1 -
\rho_{12}^2)} \times \frac{\sigma_Y}{\sigma_1}
\tag{2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:beta21">\[\begin{equation}
B_{Y2 \cdot 1} = \frac{\rho_{Y2} - \rho_{Y1}\rho_{21}}{(1 -
\rho_{21}^2)} \times \frac{\sigma_Y}{\sigma_2}
\tag{3}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(\rho\)</span> stands for the
populational correlation coefficient and <span
class="math inline">\(\sigma\)</span> for the populational standard
deviation. Unless we have uncorrelated predictors (i.e. <span
class="math inline">\(\rho_{12}\)</span> = 0), the value for any of the
regression coefficients is determined by which other predictors are in
the model. If either one is excluded from the model, a different
regression coefficient will be estimated: excluding <span
class="math inline">\(X_2\)</span>, for example, would zero all the
correlations involving this predictor, leaving,</p>
<p><span class="math display" id="eq:beta12exc">\[\begin{equation}
B_{Y1 \cdot 2} = \frac{\rho_{Y1} - 0 \times 0}{(1 - 0^2)} \times
\frac{\sigma_Y}{\sigma_1} = \rho_{Y1} \times \frac{\sigma_Y}{\sigma_1} =
B_{Y1}
\tag{4}
\end{equation}\]</span></p>
<p><span class="citation"
data-cites="berkStatisticalInferenceModel2010">Berk et al. (<a
href="#ref-berkStatisticalInferenceModel2010"
role="doc-biblioref">2010</a>)</span> warns that the sampling
distribution of the estimated regression parameters is distorted because
estimates made from incorrect models will also be included, resulting in
a mixture of distributions. Therefore, the model selection process must
be taken into account in the regression estimation whenever it is
applied.</p>
<h2 id="illustration">Illustration</h2>
<p>We can illustrate the discussion above expanding an analytic example
given by <span class="citation"
data-cites="berkStatisticalInferenceModel2010">Berk et al. (<a
href="#ref-berkStatisticalInferenceModel2010"
role="doc-biblioref">2010</a>)</span> with simulations. Consider a model
for a response variable <span class="math inline">\(y\)</span> with two
potential regressors, <span class="math inline">\(x\)</span> and <span
class="math inline">\(z\)</span>. Say we are interested in the
relationship between <span class="math inline">\(y\)</span> and <span
class="math inline">\(x\)</span> while holding <span
class="math inline">\(z\)</span> constant, that is, <span
class="math inline">\(\hat{\beta}_{yx\cdot z}\)</span>. Framing this as
a linear regression model we have</p>
<p><span class="math display" id="eq:m1">\[\begin{equation}
y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \varepsilon_i
\tag{5}
\end{equation}\]</span></p>
<p>Now, suppose that we’re in a scenario where <span
class="math inline">\(\rho_{xz}\)</span> = 0.5, both <span
class="math inline">\(\beta_1\)</span> and <span
class="math inline">\(\beta_2\)</span> are set to 1 and <span
class="math inline">\(\varepsilon \sim N(0, 10)\)</span>. We’ll use a
sample size of 250 subjects, and 1,000 random samples will be drawn from
this population. We’ll calculate <em>coverage</em> and <em>bias</em> for
each regressor. Coverage informs the frequency in which the true
coefficient value is captured by the 95% confidence interval (CI) of the
estimate. The bias of the estimations is calculated as <span
class="math inline">\(\frac{1}{R}\sum(\hat{\theta_r}-\theta)\)</span>,
where <span class="math inline">\(R\)</span> is the number of
repetitions, <span class="math inline">\(\theta\)</span> represents a
population parameter, and <span
class="math inline">\(\hat{\theta}_r\)</span> a sample estimate in each
simulation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>2</span> <span class='co'># number of predictors</span>
<span class='va'>Sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>.5</span>, <span class='va'>p</span>, <span class='va'>p</span><span class='op'>)</span> <span class='co'># correlation matrix</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>Sigma</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>250</span> <span class='co'># sample size</span>
<span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fl'>10</span> <span class='co'># intercept (can be set to any value)</span>
<span class='va'>betas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span> 
<span class='va'>reps</span> <span class='op'>=</span> <span class='fl'>1000</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='va'>cover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'># defining the matrices to store simulation results</span>


<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># X is a matrix of regression coefficients</span>
  <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
  <span class='co'># with the values randomly drawn in X, we'll estimate values for y</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>betas</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
  <span class='co'># fit a linear model with x and z to predict y</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
  <span class='va'>coefs</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># save the regression coefficients</span>
  <span class='va'>cis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='co'># save the 95% CIs</span>
  <span class='co'># if the true value is capture by the CI, sum 1, 0 otherwise </span>
  <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>cis</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span>

<span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>
  Predictor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>,
  Coverage <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span>,
  Bias <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>betas</span><span class='op'>)</span>
<span class='op'>)</span> |&gt; 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Predictor</th>
<th style="text-align: right;">Coverage</th>
<th style="text-align: right;">Bias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">-0.0021765</td>
</tr>
<tr class="even">
<td style="text-align: left;">z</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: right;">0.0002368</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>coefs</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, 
        axis.ticks.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Values of "</span>, <span class='va'>beta</span><span class='op'>[</span><span class='va'>yx.z</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:plot-ex1a"></span>
<img src="model-selection-bias_files/figure-html5/plot-ex1a-1.png" alt="Sampling distributions of the regression coefficient for regressor $x$ in the full model." width="624" />
<p class="caption">
Figure 1: Sampling distributions of the regression coefficient for
regressor <span class="math inline">\(x\)</span> in the full model.
</p>
</div>
</div>
<p>In this first scenario <span class="math inline">\(\beta_{yx\cdot
z}\)</span> is estimated assuming <span class="math inline">\(x\)</span>
and <span class="math inline">\(z\)</span> are always included in the
model.</p>
<p>What would happen if by model selection we arrive at a model where
<span class="math inline">\(z\)</span> is excluded? As indicated in
equation <a href="#eq:beta12exc">(4)</a>, if <span class="math inline">\(z\)</span>
is excluded, any correlation where <span
class="math inline">\(z\)</span> is involved is equivalent to zero, and
we’re left with,</p>
<p><span class="math display" id="eq:ex11">\[\begin{equation}
\beta_{yx} = \rho_{xy}(\frac{\sigma_y}{\sigma_x})
\tag{6}
\end{equation}\]</span></p>
<p>Note that <span class="math inline">\(\beta_{yx}\)</span> is not the
same as <span class="math inline">\(\beta_{yx\cdot z}\)</span>. If we do
not have a model specified prior to data collection and analysis, it is
not clear which definition of regression parameter for <span
class="math inline">\(x\)</span> we’re trying to estimate, if <span
class="math inline">\(\beta_{yx\cdot z}\)</span>, as exemplified on
equation <a href="#eq:beta12">(2)</a>, or if <span
class="math inline">\(\beta_{yx}\)</span> from <a href="#eq:ex11">(6)</a>. Therefore,
the definition of <span class="math inline">\(\hat{\beta}_1\)</span>
depends on the model in which it is placed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>Sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>.5</span>, <span class='va'>p</span>, <span class='va'>p</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>Sigma</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>250</span>
<span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>betas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>reps</span> <span class='op'>=</span> <span class='fl'>1000</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='va'>cover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'>#print(i)</span>
  <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>betas</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
  <span class='va'>coefs</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>cis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span>
  <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>cis</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span>
<span class='co'># coverage</span>
<span class='va'>cover1b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='co'># bias</span>
<span class='va'>bias1b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>betas</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>coefs</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_classic</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, 
        axis.ticks.y<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Values of "</span>, <span class='va'>beta</span><span class='op'>[</span><span class='va'>yx</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:plot-ex1b"></span>
<img src="model-selection-bias_files/figure-html5/plot-ex1b-1.png" alt="Sampling distributions of the regression coefficient for regressor X in a reduced model where Z is excluded." width="624" />
<p class="caption">
Figure 2: Sampling distributions of the regression coefficient for
regressor X in a reduced model where Z is excluded.
</p>
</div>
</div>
<p>Notice how far off the model estimates the coefficient for <span
class="math inline">\(x\)</span> when we fit our model as
<code>y ~ x</code>. Under these conditions, we should expect a coverage
of the true coefficient value of <span class="math inline">\(x\)</span>
of 0.331 and a bias of 0.292. Under the correct model, bias is
negligible and coverage follows the Type I error rate of 5% that we’ve
set for this exercise.</p>
<p>This simple example help us understand why estimating model
parameters in the same single random sample used to find an appropriate
model isn’t a good idea (at least not without taking this process into
account prior to making inferences). Discarding <span
class="math inline">\(z\)</span> from our model has distorted the
sampling distribution of <span class="math inline">\(x\)</span>. Thus,
as <span class="citation"
data-cites="berkStatisticalInferenceModel2010">Berk et al. (<a
href="#ref-berkStatisticalInferenceModel2010"
role="doc-biblioref">2010</a>)</span> puts it: “when a single model is
not specified before the analysis begins, it is not clear what
population parameter is the subject of study. And without this clarity,
the reasoning behind statistical inference becomes obscure”.</p>
<h1 id="other-issues">Other issues</h1>
<p>We already know that if two predictors are moderately correlated and
one is dropped from the model, our estimation will be biased. But what
else should we consider? If we are selecting the variable every time,
then there is not an issue. In the following sections we’ll consider
what can make things go “bad”. Before that, please consider the equation
for the standard error of the regression coefficient, estimated in the
example model selection,</p>
<p><span class="math display" id="eq:sebxy">\[\begin{equation}
SE(\beta_{yx\cdot z}) = \frac{\hat{\sigma_{\varepsilon}}}{s_x
\sqrt{n-1}}\sqrt{\frac{1}{1-r^2_{xy}}}
\tag{7}
\end{equation}\]</span></p>
<p>We have that <span
class="math inline">\(\hat{\sigma_{\varepsilon}}\)</span> is an estimate
of the residual standard deviation, <span
class="math inline">\(s_x\)</span> is the sample standard deviation of
<span class="math inline">\(x\)</span>, <span
class="math inline">\(r^2_{xy}\)</span> is the square of the sample
correlation between <span class="math inline">\(x\)</span> and <span
class="math inline">\(z\)</span>, and <span
class="math inline">\(n\)</span> is the sample size. If the standard
error for a regression coefficient is large, it means that its
distribution will be more dispersed. So, from this equation, we identify
as crucial parameters for a wider sampling distribution: larger residual
variance, less variance in <span class="math inline">\(x\)</span>,
smaller sample size, and, stronger correlation between regressors and
the response variable.</p>
<p>We’ll use simulated data to aid our understanding. I have build a <a
href="https://marwin.shinyapps.io/model-selection-app/">ShinyApp</a> for
that end. Its purpose is to illustrate the problems that arise when
model selection, parameters estimation and statistical inferences are
undertaken with the same data set. Although I will be working with code
in this post, most of it can also be reproduced with this app.</p>
<p>For convenience purposes, I’ll use the stepwise approach for model
selection with AIC as model selection criterion. Some penalties are
harsher than others, but the concerns raised here are irrespective of
the chosen model selection method <span class="citation"
data-cites="berkStatisticalInferenceModel2010">(<a
href="#ref-berkStatisticalInferenceModel2010" role="doc-biblioref">Berk
et al., 2010</a>)</span>. In the app, I also provide the option to
choose BIC or Mallow’s Cp as selection method. In addition to bias and
coverage, we’ll also estimate the average Mean Squared Error (MSE),
calculated as <span
class="math inline">\(\frac{1}{R}\sum[(\hat{\theta_r}-\theta)^2]\)</span>.</p>
<h2 id="noise">Noise</h2>
<p>To express variability we can use a signal-to-noise ratio (SNR),
defined here as:</p>
<p><span class="math display" id="eq:snr">\[\begin{equation}
\frac{S}{N} = \textbf{b}\Sigma\textbf{b}\sigma^{-2}
\tag{8}
\end{equation}\]</span></p>
<p>where, <span class="math inline">\(\textbf{b}\)</span> is a
(<em>p</em> + 1) vector of regression coefficients, <span
class="math inline">\(\Sigma\)</span> is the covariance matrix of
predictors and <span class="math inline">\(\sigma^2\)</span> is the
error term variance. Note that “model selection bias also occurs when an
explanatory variable has a weak relationship with the response variable.
The relationship is real, but small. Therefore, it is rarely selected as
significant” <span class="citation"
data-cites="lukacsModelSelectionBias2009">(<a
href="#ref-lukacsModelSelectionBias2009" role="doc-biblioref">Lukacs et
al., 2009, p. 118</a>)</span>. We can experiment with a range of values
for the <span class="math inline">\(SNR\)</span> to see how it affects
the estimates. We’ll use most values set in our first simulation
exercise and <span class="math inline">\(SNR\)</span> values ranging
from 0.1 to 2. One thousand (1,000) simulations will be run for each of
those values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_bias</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>reps</span>, <span class='va'>p</span>, <span class='va'>n</span>, <span class='va'>SNR</span>, <span class='va'>b</span>, <span class='va'>corr</span><span class='op'>)</span> <span class='op'>{</span>
  
  
  <span class='va'>Sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>corr</span>, <span class='va'>p</span>, <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>Sigma</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>b</span>, <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>beta</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>sigma_error</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>crossprod</a></span><span class='op'>(</span><span class='va'>beta</span>, <span class='va'>Sigma</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>beta</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>SNR</span><span class='op'>)</span><span class='op'>)</span>

  <span class='va'>rsq</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='va'>tvals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
  <span class='va'>cover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tvals</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>p</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>beta</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
  <span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/step.html'>step</a></span><span class='op'>(</span><span class='va'>fit</span>, k <span class='op'>=</span> <span class='fl'>2</span>, trace <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span>
  <span class='va'>tval</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>tvals</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span>  <span class='va'>tval</span>
  <span class='va'>coefs</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>rsq</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>r.squared</span>
  <span class='va'>cis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span>
                <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&amp;</span> <span class='va'>cis</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
            <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
                <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&amp;</span> <span class='va'>cis</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
            <span class='op'>}</span>
  
<span class='op'>}</span>

<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  SNR <span class='op'>=</span> <span class='va'>SNR</span>,
  N <span class='op'>=</span> <span class='va'>n</span>,
  Predictor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>,
  Estimate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>coefs</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  Coverage <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span>,
  Bias <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>beta</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  MSE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>beta</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>res</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_snr</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dfr</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>reps <span class='op'>=</span> <span class='fl'>1000</span>, p <span class='op'>=</span> <span class='fl'>2</span>, n <span class='op'>=</span> <span class='fl'>250</span>, SNR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.01</span>, <span class='fl'>.1</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='fl'>1</span>, corr <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>, <span class='va'>sim_bias</span><span class='op'>)</span>

<span class='va'>sim_snr</span> |&gt; 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">SNR</th>
<th style="text-align: right;">N</th>
<th style="text-align: left;">Predictor</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Coverage</th>
<th style="text-align: right;">Bias</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">2.254160</td>
<td style="text-align: right;">0.273</td>
<td style="text-align: right;">1.2541599</td>
<td style="text-align: right;">3.0918143</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">2.255364</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">1.2553637</td>
<td style="text-align: right;">2.7999289</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.120820</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: right;">0.1208199</td>
<td style="text-align: right;">0.1318663</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.136204</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.1362038</td>
<td style="text-align: right;">0.1423123</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.002278</td>
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">0.0022780</td>
<td style="text-align: right;">0.0330896</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.002425</td>
<td style="text-align: right;">0.944</td>
<td style="text-align: right;">0.0024253</td>
<td style="text-align: right;">0.0330270</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.000348</td>
<td style="text-align: right;">0.953</td>
<td style="text-align: right;">0.0003476</td>
<td style="text-align: right;">0.0172397</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.005363</td>
<td style="text-align: right;">0.941</td>
<td style="text-align: right;">0.0053633</td>
<td style="text-align: right;">0.0175405</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.001448</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">0.0014484</td>
<td style="text-align: right;">0.0080525</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.000422</td>
<td style="text-align: right;">0.955</td>
<td style="text-align: right;">0.0004223</td>
<td style="text-align: right;">0.0081412</td>
</tr>
</tbody>
</table>
</div>
<p>As expected, with greater amount of noise in relation to signal, the
selected model includes the true coefficient at smaller frequencies.
Because model selection interferes with the true model composition,
coefficient estimates deviate from its true value. In this particular
setting, with <span class="math inline">\(SNR\)</span> <span
class="math inline">\(\ge\)</span> 0.5, coverage frequency approximates
95% and the estimates get closer to their true value. Measures of bias
and MSE are also useful to display how our uncertainty gets smaller with
less variability in the data.</p>
<h2 id="sample-size">Sample size</h2>
<p>Once we know <a href="#eq:sebxy">(7)</a> it is not difficult to suppose that
larger samples produce smaller standard errors for the regression
coefficients. We can confirm that using our <code>sim_bias</code>
function again, but this time varying sample sizes.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_ss</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map2.html'>pmap_dfr</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>reps <span class='op'>=</span> <span class='fl'>1000</span>, p <span class='op'>=</span> <span class='fl'>2</span>, n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>500</span><span class='op'>)</span>, SNR <span class='op'>=</span> <span class='fl'>0.5</span>, b <span class='op'>=</span> <span class='fl'>1</span>, corr <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>, <span class='va'>sim_bias</span><span class='op'>)</span>
<span class='va'>sim_ss</span>|&gt; 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">SNR</th>
<th style="text-align: right;">N</th>
<th style="text-align: left;">Predictor</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Coverage</th>
<th style="text-align: right;">Bias</th>
<th style="text-align: right;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.7821164</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">0.7821164</td>
<td style="text-align: right;">1.8154154</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.7631147</td>
<td style="text-align: right;">0.420</td>
<td style="text-align: right;">0.7631147</td>
<td style="text-align: right;">1.7030914</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.1559202</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.1559202</td>
<td style="text-align: right;">0.1581577</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.1320348</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.1320348</td>
<td style="text-align: right;">0.1609578</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">1.0091587</td>
<td style="text-align: right;">0.947</td>
<td style="text-align: right;">0.0091587</td>
<td style="text-align: right;">0.0787849</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.0155997</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: right;">0.0155997</td>
<td style="text-align: right;">0.0771958</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">200</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.9997200</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">-0.0002800</td>
<td style="text-align: right;">0.0404224</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">200</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">1.0028285</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">0.0028285</td>
<td style="text-align: right;">0.0367576</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">500</td>
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.9955639</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">-0.0044361</td>
<td style="text-align: right;">0.0156709</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">500</td>
<td style="text-align: left;">x2</td>
<td style="text-align: right;">0.9993026</td>
<td style="text-align: right;">0.960</td>
<td style="text-align: right;">-0.0006974</td>
<td style="text-align: right;">0.0148245</td>
</tr>
</tbody>
</table>
</div>
<h2 id="candidate-predictors">Candidate predictors</h2>
<p>OK, so far we’ve seen that with 2 predictors, each with true
coefficient values of 1 and a correlation of 0.5, we get more precise
estimates when <span class="math inline">\(SNR \ge\)</span> 0.5 and
<span class="math inline">\(n \ge\)</span> 100. The number of candidate
predictor variables and its covariance matrix are two important aspects
not addressed yet. To demonstrate their influence we can run simulations
with varying values for each, where each case will have a different
combination of number of predictors and correlation between them.</p>
<p>For simplicity, all the off-diagonal elements the correlation matrix
of predictors will be equal, meaning the that every predictor in the
full model is correlated with the others by the same degree. We’ll need
to do a slight modification on our previous function so we can then
apply a new function for each combination and build a dataframe
summarizing our results.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_bias_multi</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>reps</span>, <span class='va'>p</span>, <span class='va'>n</span>, <span class='va'>SNR</span>, <span class='va'>b</span>, <span class='va'>corr</span><span class='op'>)</span> <span class='op'>{</span>
  
  
  <span class='va'>Sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>corr</span>, <span class='va'>p</span>, <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>Sigma</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>b</span>, <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>beta</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='va'>b0</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>sigma_error</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>crossprod</a></span><span class='op'>(</span><span class='va'>beta</span>, <span class='va'>Sigma</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>beta</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>SNR</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>rsq</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
  <span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='va'>tvals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
  <span class='va'>cover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tvals</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    
    <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>p</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b0</span>, <span class='va'>beta</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='va'>sigma_error</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>p</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
    <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
    <span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/step.html'>step</a></span><span class='op'>(</span><span class='va'>fit</span>, k <span class='op'>=</span> <span class='fl'>2</span>, trace <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
    <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span>
    <span class='va'>tval</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
    <span class='va'>tvals</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span>  <span class='va'>tval</span>
    <span class='va'>coefs</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
    <span class='va'>rsq</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>r.squared</span>
    <span class='va'>cis</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&amp;</span> 
                                       <span class='va'>cis</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='va'>cover</span><span class='op'>[</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>cis</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&amp;</span> 
                                       <span class='va'>cis</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='va'>beta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tval</span><span class='op'>)</span><span class='op'>]</span>, 
                                     <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>
    <span class='op'>}</span>
    
  <span class='op'>}</span>
  
  <span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>coefs <span class='op'>=</span> <span class='va'>coefs</span>, tvals <span class='op'>=</span> <span class='va'>tvals</span>, cover <span class='op'>=</span> <span class='va'>cover</span>, 
              bias <span class='op'>=</span> <span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>beta</span>, mse <span class='op'>=</span> <span class='op'>(</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='va'>beta</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span>, rsq <span class='op'>=</span> <span class='va'>rsq</span>, 
              corr <span class='op'>=</span> <span class='va'>corr</span>, p <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>
  
  <span class='va'>res</span>

<span class='op'>}</span>

<span class='va'>sim_summary</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>l</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>
    
    cor <span class='op'>=</span> <span class='va'>l</span><span class='op'>$</span><span class='va'>corr</span>,
    npred <span class='op'>=</span> <span class='va'>l</span><span class='op'>$</span><span class='va'>p</span>,
    predictor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>cover</span><span class='op'>)</span>,
    coverage <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>cover</span><span class='op'>)</span>,
    estimate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>coefs</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    bias <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    mse <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>coefs</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    rsq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>$</span><span class='va'>rsq</span><span class='op'>)</span>
    
  <span class='op'>)</span>
  <span class='va'>df</span>
  
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>To keep the computing load at reasonable levels, we’ll limit the
length of vectors of <span class="math inline">\(p\)</span> and <span
class="math inline">\(\rho\)</span> to 10 values each. Our grid for
<span class="math inline">\(\rho\)</span> ranges from 0.1 to 0.9 and
we’ll increase <span class="math inline">\(p\)</span> from 2 to 10.
We’ll set <span class="math inline">\(SNR\)</span> = 0.5, <span
class="math inline">\(n\)</span> = 100 and set all true coefficient
values to 1. Again, we’re using AIC to select the best model, and
performing 1,000 simulation replicates.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>future</span><span class='fu'>::</span><span class='fu'><a href='https://future.futureverse.org/reference/plan.html'>plan</a></span><span class='op'>(</span><span class='fu'>future</span><span class='fu'>::</span><span class='va'><a href='https://future.futureverse.org/reference/multisession.html'>multisession</a></span><span class='op'>)</span>
<span class='va'>sims</span> <span class='op'>&lt;-</span> <span class='fu'>furrr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span>, 
                          <span class='op'>~</span><span class='fu'>furrr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map2.html'>future_pmap</a></span><span class='op'>(</span>
                            <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                              reps <span class='op'>=</span> <span class='fl'>1000</span>, p <span class='op'>=</span> <span class='va'>.x</span>, n <span class='op'>=</span> <span class='fl'>100</span>, SNR <span class='op'>=</span> <span class='fl'>0.5</span>, <span class='fl'>1</span>, 
                              corr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.9</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>,
                                <span class='va'>sim_bias_multi</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>simdf</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_dfr</a></span><span class='op'>(</span><span class='va'>sims</span>, <span class='va'>sim_summary</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simdfplot</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"coverage"</span>, <span class='st'>"bias"</span>, <span class='st'>"mse"</span>, <span class='st'>"rsq"</span><span class='op'>)</span>, <span class='va'>scale</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>coverage</span>, <span class='va'>bias</span>, <span class='va'>mse</span>, <span class='va'>rsq</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"measure"</span>, values_to <span class='op'>=</span> <span class='st'>'value'</span><span class='op'>)</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>measure <span class='op'>=</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span><span class='va'>measure</span>, <span class='st'>"coverage"</span> <span class='op'>=</span> <span class='st'>"Coverage"</span>, <span class='st'>"bias"</span> <span class='op'>=</span> <span class='st'>"Bias"</span>, <span class='st'>"mse"</span> <span class='op'>=</span> <span class='st'>"MSE"</span>, <span class='st'>"rsq"</span> <span class='op'>=</span> <span class='st'>"R^2"</span><span class='op'>)</span><span class='op'>)</span> |&gt;
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>cor</span>, y <span class='op'>=</span> <span class='va'>npred</span>, fill <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_fill_viridis_c</a></span><span class='op'>(</span>direction <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, option <span class='op'>=</span> <span class='st'>"inferno"</span>, alpha <span class='op'>=</span> <span class='fl'>.9</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>8</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>latex2exp</span><span class='fu'>::</span><span class='fu'><a href='https://www.stefanom.io/latex2exp/reference/TeX.html'>TeX</a></span><span class='op'>(</span><span class='st'>"$\\rho$"</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='st'>"p"</span>, fill <span class='op'>=</span> <span class='st'>"SD"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>measure</span>, scales <span class='op'>=</span> <span class='st'>"free"</span>, 
             labeller <span class='op'>=</span> <span class='va'>label_parsed</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:simplots"></span>
<img src="model-selection-bias_files/figure-html5/simplots-1.png" alt="Standardized measures of Bias, Coverage, Mean Square Error (MSE) and R2, across each simulation of pairs of number of predictors and correlation values" width="1950" />
<p class="caption">
Figure 3: Standardized measures of Bias, Coverage, Mean Square
Error (MSE) and R2, across each simulation of pairs of number of
predictors and correlation values
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://glin.github.io/reactable/reference/reactable.html'>reactable</a></span><span class='op'>(</span><span class='va'>simdf</span>, pageSizeOptions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>15</span><span class='op'>)</span>, defaultPageSize <span class='op'>=</span> <span class='fl'>10</span>, fullWidth <span class='op'>=</span> <span class='cn'>TRUE</span>,
          columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    npred <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"p"</span>, filterable <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    cor <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Correlation"</span>, filterable <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    predictor <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Predictor"</span><span class='op'>)</span>,
    coverage <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Coverage"</span><span class='op'>)</span>,
    estimate <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Estimate"</span>, format <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colFormat.html'>colFormat</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
    bias <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Bias"</span>, format <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colFormat.html'>colFormat</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
    mse <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"MSE"</span>, format <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colFormat.html'>colFormat</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
    rsq <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"R2"</span>, format <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/colFormat.html'>colFormat</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div id="htmlwidget-c90586d5830672ba732d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c90586d5830672ba732d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"cor":[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.1,0.1,0.2,0.2,0.3,0.3,0.4,0.4,0.5,0.5,0.6,0.6,0.7,0.7,0.8,0.8,0.9,0.9,0.1,0.1,0.1,0.2,0.2,0.2,0.3,0.3,0.3,0.4,0.4,0.4,0.5,0.5,0.5,0.6,0.6,0.6,0.7,0.7,0.7,0.8,0.8,0.8,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"npred":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],"predictor":["x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9","x1","x2","x3","x4","x5","x6","x7","x8","x9"],"coverage":[0.565,0.534,0.575,0.572,0.559,0.569,0.552,0.546,0.591,0.553,0.444,0.455,0.43,0.457,0.45,0.462,0.463,0.454,0.432,0.429,0.379,0.342,0.384,0.401,0.38,0.357,0.355,0.357,0.349,0.409,0.324,0.285,0.305,0.293,0.307,0.319,0.317,0.322,0.308,0.32,0.252,0.239,0.283,0.248,0.275,0.256,0.258,0.26,0.253,0.26,0.238,0.219,0.21,0.206,0.217,0.203,0.227,0.23,0.224,0.222,0.174,0.191,0.176,0.208,0.178,0.167,0.199,0.189,0.196,0.176,0.156,0.148,0.147,0.159,0.138,0.147,0.135,0.153,0.142,0.161,0.136,0.13,0.122,0.123,0.118,0.112,0.119,0.135,0.138,0.112,0.948,0.956,0.938,0.954,0.95,0.953,0.95,0.943,0.933,0.941,0.916,0.914,0.818,0.819,0.608,0.592,0.216,0.217,0.953,0.952,0.95,0.931,0.939,0.933,0.897,0.899,0.893,0.84,0.851,0.84,0.785,0.77,0.791,0.692,0.687,0.702,0.593,0.572,0.598,0.455,0.453,0.439,0.158,0.153,0.162,0.913,0.911,0.92,0.915,0.855,0.849,0.858,0.856,0.78,0.78,0.753,0.761,0.72,0.687,0.714,0.709,0.597,0.633,0.619,0.652,0.546,0.533,0.524,0.533,0.462,0.456,0.473,0.441,0.385,0.355,0.369,0.335,0.138,0.166,0.15,0.152,0.857,0.849,0.858,0.852,0.84,0.782,0.778,0.741,0.789,0.771,0.673,0.68,0.674,0.681,0.669,0.619,0.576,0.589,0.617,0.544,0.512,0.513,0.536,0.52,0.484,0.466,0.425,0.406,0.464,0.434,0.378,0.35,0.357,0.358,0.37,0.274,0.284,0.302,0.298,0.282,0.139,0.16,0.142,0.158,0.136,0.76,0.777,0.764,0.783,0.762,0.793,0.668,0.653,0.677,0.663,0.665,0.655,0.566,0.604,0.6,0.564,0.582,0.587,0.488,0.512,0.519,0.496,0.518,0.496,0.422,0.427,0.438,0.428,0.443,0.427,0.368,0.359,0.377,0.377,0.37,0.366,0.28,0.295,0.299,0.286,0.302,0.299,0.246,0.215,0.265,0.226,0.25,0.231,0.134,0.133,0.128,0.152,0.151,0.129,0.732,0.706,0.684,0.723,0.72,0.711,0.706,0.628,0.598,0.608,0.585,0.6,0.607,0.606,0.532,0.485,0.554,0.517,0.534,0.517,0.488,0.43,0.439,0.455,0.433,0.44,0.437,0.42,0.345,0.369,0.401,0.384,0.387,0.4,0.375,0.315,0.31,0.296,0.31,0.298,0.321,0.306,0.258,0.243,0.234,0.247,0.266,0.234,0.232,0.176,0.193,0.202,0.197,0.217,0.222,0.212,0.122,0.138,0.157,0.142,0.13,0.138,0.133,0.632,0.656,0.647,0.644,0.667,0.661,0.661,0.666,0.546,0.536,0.515,0.55,0.54,0.542,0.543,0.552,0.443,0.434,0.515,0.442,0.474,0.444,0.474,0.443,0.402,0.371,0.385,0.395,0.364,0.379,0.367,0.397,0.331,0.339,0.321,0.35,0.324,0.339,0.335,0.331,0.298,0.261,0.292,0.289,0.287,0.283,0.268,0.269,0.202,0.197,0.229,0.235,0.201,0.248,0.214,0.256,0.171,0.184,0.174,0.193,0.173,0.187,0.196,0.184,0.125,0.139,0.134,0.119,0.136,0.121,0.14,0.138,0.615,0.627,0.596,0.613,0.589,0.614,0.607,0.616,0.59,0.476,0.487,0.509,0.491,0.466,0.51,0.486,0.506,0.507,0.422,0.392,0.428,0.421,0.385,0.418,0.395,0.42,0.387,0.355,0.365,0.341,0.37,0.375,0.345,0.34,0.347,0.372,0.31,0.295,0.282,0.306,0.298,0.311,0.284,0.27,0.308,0.246,0.248,0.251,0.243,0.256,0.252,0.238,0.26,0.239,0.206,0.168,0.199,0.184,0.191,0.219,0.19,0.188,0.22,0.175,0.156,0.149,0.155,0.174,0.165,0.167,0.156,0.157,0.128,0.155,0.125,0.117,0.13,0.13,0.127,0.147,0.136],"estimate":[1.48212455427486,1.50320660781006,1.5270088560898,1.49374880165201,1.53159770593366,1.47138408431054,1.50399057598131,1.4755527287169,1.52601723355963,1.49245028335111,1.81832470153324,1.81459596759042,1.79983761507829,1.84643491519722,1.78529937151446,1.79054965857971,1.8342570462384,1.84261890943984,1.8272593646198,1.81665115781513,2.09061869824378,2.09112700690235,2.17816427657677,2.03686803053617,2.15321288550206,2.05884149763904,2.17103109551452,2.17062963690638,2.1219332704338,2.15493026118875,2.46381365343474,2.52098253777995,2.43572166448287,2.34669802638196,2.3848617740815,2.41047803601028,2.33134668488213,2.48699093571909,2.47422950402301,2.35757793895972,2.77778215150291,2.73159401060911,2.7427057742391,2.71988993250759,2.77109619956861,2.8027655394593,2.86544701588114,2.75218531994526,2.63999613561842,2.6362102085604,2.97392252323139,3.08520189995986,3.03543428690887,3.09514989702632,3.22040808458466,3.01974637213795,2.92425456806308,3.07278285018453,3.00770228168978,3.16595460447848,3.3333260013279,3.57749993257936,3.46679385405356,3.14783473941871,3.36211621436215,3.41624532813105,3.4334562707942,3.39648856423001,3.03720789823589,3.06823316022245,3.59525995639872,3.89257578785785,4.16223894083064,3.72302684341002,3.48254111162686,4.03039590211241,4.08688806468424,3.8822535712929,3.7494221093398,4.14243358497249,4.28972849176243,4.45127093452374,4.3331315629978,3.37439041818781,3.70064150591263,4.22809486058794,4.00984595347498,4.71545694821332,4.27954653525802,4.40101700549167,0.998955979087414,0.995651567127508,1.0155292846412,1.0060263731804,1.00245787850054,1.00352364521834,1.02590521283904,1.000845970185,1.02633933146977,1.02249228844805,1.02923321645913,1.05909700885107,1.09957097761326,1.08838442363864,1.26832385247327,1.24783712068624,1.69034611242944,1.67893308889572,1.00797205031942,1.00207447731957,1.01857119104388,1.0258883029142,1.04291982004656,1.02513926421552,1.05163714416595,1.06999760035871,1.0531020336063,1.10174552103938,1.12573100049686,1.10379893400293,1.18106279549119,1.17942438114313,1.18197624848623,1.29430942133806,1.30346144507843,1.2826162474353,1.46923929480506,1.47144539072214,1.45917571384367,1.67920679602758,1.68651678466982,1.74008653601704,2.29745688007437,2.37559156733446,2.34384180046032,1.03198400078583,1.04841537398914,1.04534531927074,1.04005517476997,1.08655980827515,1.08800378830443,1.11515464340565,1.08551847858937,1.19799473952189,1.18651055185555,1.20581224964332,1.18005672467611,1.28576070996194,1.26480742934755,1.26031522892932,1.29210719932981,1.43242079707903,1.42947994639985,1.41835397495731,1.39767519714205,1.59279061684422,1.60275235113342,1.56573130945463,1.57277148156962,1.74865856587974,1.84086687984678,1.81063473625152,1.79301214381657,2.07400109426012,2.12674869551222,2.15123475118906,2.14545087194402,2.83500530342777,2.77625509537222,2.78720691990953,2.80673376623189,1.09287486105257,1.11121357966494,1.09583968551689,1.11375971019436,1.11224870582257,1.20158818759542,1.20024468092302,1.18000539898067,1.19746781043601,1.17025889094839,1.32213686938317,1.31343386394659,1.32195224569511,1.35557648755012,1.33701106669048,1.46498855439401,1.4851396417869,1.47508001420863,1.46606743325001,1.46394207155754,1.62983134547105,1.64199066426574,1.63081390083353,1.67614022046235,1.67449883974187,1.86483822561698,1.84326313587829,1.83413216680221,1.88315792110983,1.8454875510744,2.10308487312571,2.17278088573762,2.12185228880731,2.16240132496171,2.16396926325517,2.57981568496157,2.39448889962597,2.60439450993895,2.50604286013268,2.47426219810181,3.24935184314678,3.21917889528684,3.18997388872789,3.28940752998317,3.2380604634483,1.17804290440987,1.18527220881449,1.17307692795988,1.16433193027898,1.18531106485852,1.20207183685895,1.34071293341661,1.3134137361608,1.34436032891575,1.3179129672886,1.29583044768833,1.36500866731109,1.49283435467487,1.49397194718387,1.49572468571876,1.49104439214846,1.51637136273188,1.47402120354716,1.69510780614146,1.65769387152724,1.66471446348103,1.66205743235578,1.67476001780899,1.71049675361809,1.90386283430667,1.92829805738064,1.8725289300239,1.94148184221793,1.89720253501024,1.89710508973531,2.15375016366168,2.16112170224363,2.09948765932845,2.0947906346537,2.17102942841632,2.10386337745291,2.50214802774141,2.48372887005636,2.40877386019216,2.4449529126078,2.44815656298357,2.55431987289708,2.89858370995159,2.92819166364052,2.79292123398954,2.8620775228508,2.71751396052019,2.81455501927544,3.38396994911477,3.68164130666388,3.77520919369007,3.46118241141237,3.73563734052136,3.20794760200186,1.23807137851785,1.2682353344487,1.24529818130218,1.25423329113493,1.27024131275053,1.2855283175639,1.25401726424403,1.45287880732018,1.4622004086283,1.45139463577462,1.43160702659893,1.41346809317981,1.43174164256234,1.45311161250955,1.61966178776019,1.67003017614537,1.64217127530595,1.6587686276461,1.67289626303521,1.62272113083396,1.65047645123956,1.92072667841916,1.87664191537492,1.8584263974247,1.87326131958946,1.87139441163752,1.93342760863269,1.86572690225312,2.19582481464415,2.0625529850076,2.05251283347779,2.09666947126394,2.04522949622242,2.06787443869793,2.14063707584643,2.34144328364175,2.48181770904682,2.43518943286509,2.41502408935784,2.38479601648464,2.40897120393144,2.42012872815368,2.73740502162979,2.68135887758383,2.80429417460617,2.81383781718837,2.81447144772185,2.7919859611466,2.67754192238441,2.95799612487178,3.21682813939888,3.10052479368004,2.89170966355565,3.29349095771793,3.0417499939894,3.27201916028459,3.76125988954029,3.4981088448812,3.68713240597488,3.58293395416182,4.25197671376895,3.95092343113325,3.62779763585242,1.35751881288198,1.33840245970606,1.33280845655283,1.36239824327212,1.35815090698548,1.32690459743538,1.32977537938847,1.31623494596466,1.53777587546169,1.59198141576652,1.56043462061466,1.57116359971706,1.58202706547258,1.56771798810806,1.58593480267787,1.59390959351365,1.81745380621153,1.78204855871338,1.76947620217352,1.7365914034002,1.85627192605239,1.85689517093945,1.84213473002408,1.8669111092374,2.02092278254266,2.10563552194197,2.07724757395866,2.08021703150755,2.08756920409867,2.08994968022983,2.06962595822674,2.04819320645007,2.27222750855438,2.32008143423894,2.30834622560021,2.27360909415914,2.37547902803255,2.35092111806614,2.36334540990778,2.33994254958159,2.57981292812756,2.77293780820901,2.5637428294524,2.57445735136478,2.62855488330793,2.67405564331816,2.56904157663771,2.62417268603821,2.98132677249317,2.94917658407456,2.98494852437822,2.83541372966815,3.01731256884464,2.89273499322282,2.89029769596545,2.97974479051442,3.13556681113226,3.3936449550296,3.42970755307329,3.33889515157842,3.24842589672753,3.3640354440791,3.34618496996536,3.45084227365087,4.23854924222766,3.76392042641595,3.72806149108082,4.35164009184971,3.8944474709212,3.68725579805565,3.62339071110078,4.09270777074313,1.44136521432235,1.41608226552714,1.42846285277145,1.4268598713506,1.43334867310854,1.41196602105966,1.40028472249881,1.41956285655713,1.43029375980501,1.7505205058795,1.69736724108544,1.74827134111502,1.70980306350538,1.68189902308393,1.69819319089933,1.68415997151857,1.68629577409108,1.6768331249891,1.91058846912935,2.006745704366,1.95988847820776,1.98065912201925,2.04265932035511,1.95522928185444,1.88535607365754,1.97925701049629,1.95216604193218,2.26395839941933,2.27798400788536,2.15586780444527,2.21388213228252,2.22573039197846,2.21246587443768,2.17142594186249,2.2927348657588,2.27156155058234,2.60940407924593,2.52067429332541,2.46134444619684,2.53007433556577,2.52638151759335,2.40642860631669,2.53084324032477,2.50626470898909,2.58047148245131,2.82489316688177,2.86152411387006,2.98285145128028,2.83638152965567,2.88572693494137,2.81547375376285,2.89601089013983,2.84831409942473,2.71290836890375,3.02238923667426,3.06484920674609,3.38229597348044,3.23635775888632,3.36167278834093,3.08014389791938,3.31106458109456,3.11141406117286,3.1153242438063,3.49882505756341,3.70755977763134,3.91338591011114,3.32048383927023,3.60961718693885,3.65367230278392,3.54832569437659,3.43898177587181,3.71952360596091,4.27571660104566,3.67345171151948,4.1313372097409,4.15862340572599,3.96416863023053,3.62759474264931,4.26698873235809,4.29905675985984,4.34568266938424],"bias":[0.482124554274857,0.503206607810065,0.527008856089799,0.493748801652011,0.531597705933658,0.47138408431054,0.503990575981306,0.475552728716897,0.526017233559626,0.49245028335111,0.81832470153324,0.814595967590418,0.799837615078289,0.846434915197221,0.785299371514465,0.790549658579706,0.834257046238403,0.842618909439836,0.827259364619796,0.816651157815131,1.09061869824378,1.09112700690235,1.17816427657677,1.03686803053617,1.15321288550206,1.05884149763904,1.17103109551452,1.17062963690638,1.1219332704338,1.15493026118875,1.46381365343474,1.52098253777995,1.43572166448287,1.34669802638196,1.3848617740815,1.41047803601028,1.33134668488213,1.48699093571909,1.47422950402301,1.35757793895972,1.77778215150291,1.73159401060911,1.7427057742391,1.71988993250759,1.77109619956861,1.8027655394593,1.86544701588114,1.75218531994526,1.63999613561842,1.6362102085604,1.97392252323139,2.08520189995986,2.03543428690887,2.09514989702632,2.22040808458466,2.01974637213795,1.92425456806308,2.07278285018453,2.00770228168978,2.16595460447848,2.3333260013279,2.57749993257936,2.46679385405356,2.14783473941871,2.36211621436215,2.41624532813105,2.4334562707942,2.39648856423001,2.03720789823589,2.06823316022245,2.59525995639872,2.89257578785785,3.16223894083064,2.72302684341002,2.48254111162686,3.03039590211241,3.08688806468424,2.8822535712929,2.7494221093398,3.14243358497249,3.28972849176243,3.45127093452374,3.3331315629978,2.37439041818781,2.70064150591263,3.22809486058794,3.00984595347498,3.71545694821332,3.27954653525802,3.40101700549167,-0.00104402091258643,-0.00434843287249175,0.0155292846411981,0.00602637318039541,0.00245787850054155,0.00352364521834418,0.025905212839045,0.000845970185004565,0.0263393314697708,0.0224922884480482,0.0292332164591318,0.0590970088510686,0.0995709776132558,0.0883844236386376,0.268323852473271,0.247837120686242,0.690346112429441,0.678933088895716,0.00797205031942146,0.00207447731957068,0.0185711910438782,0.0258883029142014,0.0429198200465553,0.0251392642155206,0.0516371441659517,0.0699976003587117,0.0531020336063003,0.101745521039385,0.125731000496859,0.103798934002932,0.181062795491187,0.179424381143126,0.181976248486234,0.294309421338055,0.303461445078431,0.282616247435301,0.469239294805058,0.471445390722142,0.459175713843672,0.679206796027584,0.686516784669818,0.740086536017044,1.29745688007437,1.37559156733446,1.34384180046032,0.0319840007858281,0.0484153739891383,0.0453453192707358,0.0400551747699738,0.0865598082751545,0.0880037883044261,0.115154643405652,0.0855184785893724,0.197994739521893,0.186510551855554,0.205812249643323,0.180056724676113,0.285760709961942,0.264807429347554,0.260315228929317,0.29210719932981,0.432420797079033,0.429479946399855,0.418353974957307,0.39767519714205,0.592790616844216,0.602752351133425,0.565731309454635,0.572771481569624,0.74865856587974,0.840866879846781,0.810634736251517,0.793012143816566,1.07400109426012,1.12674869551222,1.15123475118906,1.14545087194402,1.83500530342777,1.77625509537222,1.78720691990953,1.80673376623189,0.0928748610525693,0.11121357966494,0.0958396855168882,0.113759710194363,0.11224870582257,0.201588187595416,0.200244680923017,0.180005398980669,0.197467810436011,0.170258890948391,0.322136869383174,0.313433863946593,0.321952245695106,0.355576487550121,0.337011066690479,0.464988554394014,0.485139641786897,0.475080014208635,0.466067433250006,0.46394207155754,0.629831345471047,0.641990664265745,0.630813900833525,0.676140220462347,0.674498839741868,0.864838225616984,0.843263135878292,0.834132166802209,0.883157921109826,0.845487551074397,1.10308487312571,1.17278088573762,1.12185228880731,1.16240132496171,1.16396926325517,1.57981568496157,1.39448889962597,1.60439450993895,1.50604286013268,1.47426219810181,2.24935184314678,2.21917889528684,2.18997388872789,2.28940752998317,2.2380604634483,0.178042904409866,0.185272208814491,0.173076927959879,0.164331930278978,0.185311064858525,0.20207183685895,0.34071293341661,0.313413736160802,0.344360328915746,0.317912967288597,0.295830447688333,0.365008667311093,0.492834354674866,0.493971947183874,0.495724685718756,0.491044392148462,0.516371362731877,0.474021203547165,0.695107806141464,0.657693871527239,0.664714463481034,0.662057432355778,0.674760017808986,0.710496753618093,0.90386283430667,0.928298057380636,0.872528930023897,0.941481842217925,0.897202535010245,0.897105089735305,1.15375016366168,1.16112170224363,1.09948765932845,1.09479063465369,1.17102942841632,1.10386337745291,1.50214802774141,1.48372887005636,1.40877386019216,1.4449529126078,1.44815656298357,1.55431987289708,1.89858370995159,1.92819166364052,1.79292123398954,1.8620775228508,1.71751396052019,1.81455501927544,2.38396994911477,2.68164130666388,2.77520919369007,2.46118241141237,2.73563734052136,2.20794760200186,0.238071378517852,0.268235334448701,0.245298181302175,0.254233291134931,0.270241312750531,0.285528317563903,0.254017264244031,0.452878807320181,0.462200408628303,0.451394635774621,0.431607026598928,0.413468093179814,0.431741642562337,0.45311161250955,0.619661787760186,0.670030176145369,0.642171275305945,0.6587686276461,0.67289626303521,0.622721130833958,0.650476451239564,0.920726678419157,0.876641915374923,0.858426397424697,0.873261319589464,0.871394411637523,0.933427608632687,0.865726902253118,1.19582481464415,1.0625529850076,1.05251283347779,1.09666947126394,1.04522949622242,1.06787443869793,1.14063707584643,1.34144328364175,1.48181770904682,1.43518943286509,1.41502408935784,1.38479601648464,1.40897120393144,1.42012872815368,1.73740502162979,1.68135887758383,1.80429417460617,1.81383781718837,1.81447144772185,1.7919859611466,1.67754192238441,1.95799612487178,2.21682813939888,2.10052479368004,1.89170966355565,2.29349095771793,2.0417499939894,2.27201916028459,2.76125988954029,2.4981088448812,2.68713240597488,2.58293395416182,3.25197671376895,2.95092343113325,2.62779763585242,0.35751881288198,0.338402459706056,0.332808456552832,0.362398243272125,0.358150906985482,0.326904597435379,0.329775379388473,0.316234945964665,0.537775875461686,0.591981415766517,0.560434620614658,0.571163599717058,0.582027065472584,0.567717988108057,0.585934802677866,0.593909593513651,0.817453806211533,0.782048558713376,0.769476202173516,0.736591403400205,0.856271926052386,0.856895170939452,0.842134730024076,0.866911109237399,1.02092278254266,1.10563552194197,1.07724757395866,1.08021703150755,1.08756920409867,1.08994968022983,1.06962595822674,1.04819320645007,1.27222750855438,1.32008143423894,1.30834622560021,1.27360909415914,1.37547902803255,1.35092111806614,1.36334540990778,1.33994254958159,1.57981292812756,1.77293780820901,1.5637428294524,1.57445735136478,1.62855488330793,1.67405564331816,1.56904157663771,1.62417268603821,1.98132677249317,1.94917658407456,1.98494852437822,1.83541372966815,2.01731256884464,1.89273499322282,1.89029769596545,1.97974479051442,2.13556681113226,2.3936449550296,2.42970755307329,2.33889515157842,2.24842589672753,2.3640354440791,2.34618496996536,2.45084227365087,3.23854924222766,2.76392042641595,2.72806149108082,3.35164009184971,2.8944474709212,2.68725579805565,2.62339071110078,3.09270777074313,0.441365214322349,0.416082265527138,0.428462852771452,0.426859871350598,0.43334867310854,0.411966021059659,0.400284722498806,0.419562856557134,0.430293759805006,0.750520505879501,0.697367241085441,0.748271341115024,0.709803063505385,0.681899023083932,0.69819319089933,0.684159971518573,0.686295774091084,0.6768331249891,0.910588469129349,1.006745704366,0.959888478207755,0.980659122019248,1.04265932035511,0.955229281854442,0.885356073657543,0.979257010496288,0.952166041932185,1.26395839941933,1.27798400788536,1.15586780444527,1.21388213228252,1.22573039197846,1.21246587443768,1.17142594186249,1.2927348657588,1.27156155058234,1.60940407924593,1.52067429332541,1.46134444619684,1.53007433556577,1.52638151759335,1.40642860631669,1.53084324032477,1.50626470898909,1.58047148245131,1.82489316688177,1.86152411387006,1.98285145128028,1.83638152965567,1.88572693494137,1.81547375376285,1.89601089013983,1.84831409942473,1.71290836890375,2.02238923667426,2.06484920674609,2.38229597348044,2.23635775888632,2.36167278834093,2.08014389791938,2.31106458109456,2.11141406117286,2.1153242438063,2.49882505756341,2.70755977763134,2.91338591011114,2.32048383927023,2.60961718693885,2.65367230278392,2.54832569437659,2.43898177587181,2.71952360596091,3.27571660104566,2.67345171151948,3.1313372097409,3.15862340572599,2.96416863023053,2.62759474264931,3.26698873235809,3.29905675985984,3.34568266938424],"mse":[0.483609597161079,0.47311293123205,0.499844721447982,0.463830128072564,0.542678769490974,0.450135505745018,0.473145332860854,0.527597207663229,0.50795880424507,0.475360596447631,1.12225678309505,0.948538636514823,1.00273925888537,1.12578451971196,1.11593792111527,0.918245598765458,1.04117649551153,1.02987273312095,1.11538566028793,1.16245167644099,1.83776833762655,1.9131574991927,2.02649732866849,1.85725444612446,1.93218923029197,1.98049733836036,2.05934067768938,2.05490035683638,1.86167153680256,1.88398729890469,3.278361286942,3.44112983265994,3.29491166866565,3.06452158429882,3.13078309392043,3.04708873665315,3.14623976498913,3.16429949178046,3.17131769190241,3.19555217151217,4.87752933407601,5.48590529745113,4.91451913334066,5.36441163490556,5.11455714815312,5.10699622136618,5.10226857473783,5.1072550632951,4.99256199218998,4.96331576693586,7.26112196947102,7.76358819453774,7.85789902379355,7.6932059306748,7.44806472674615,8.20448011045782,7.32482129515943,7.37593593664412,7.19791974686567,8.12785236763795,12.4826898060112,11.9540404020288,12.2497529124393,12.2382503234896,12.899844334225,12.6523428330765,12.7235190215426,11.6221923758943,12.8693079952792,12.3885352326031,21.616411040718,22.0628314267032,21.8433902080944,20.2897754330305,22.4405856031799,21.199216428739,19.8264009645492,21.7359621027186,22.4509152978825,22.4556036887426,53.2055591303548,54.0682017879541,53.7484459240023,52.7706424414638,55.0271365654644,52.9012683701907,56.1026397020395,51.1894488848529,47.4380135668625,50.2214348240944,0.0438365388201666,0.0446167259204864,0.0540930813242653,0.050736026369279,0.0590975677359227,0.0601109996450251,0.069498961741416,0.0651199236751007,0.0741006316051195,0.0748425129065311,0.0888545187380685,0.0940978837248193,0.129095989389957,0.135026679501562,0.255980325272649,0.253509039058915,0.6931429119944,0.707471936368468,0.0712389543626044,0.0694822001500392,0.0712095757649367,0.0845229654574395,0.0856919835405342,0.0765692860592476,0.100825724804625,0.101350004160052,0.104113643046453,0.128645061616352,0.125053697183127,0.123393949012056,0.162614981363428,0.170655852224951,0.160269076191933,0.24554393037807,0.261702966352131,0.260366053756493,0.413858366954144,0.446629672492603,0.408223345048976,0.829440283528978,0.845105317247706,0.910431514246064,2.3513019413704,2.59731422291693,2.48488038336935,0.0946966547603108,0.096070062281674,0.0969664443701743,0.0877978380667571,0.116736550191964,0.118866917147583,0.122150742105318,0.11108414766286,0.172307874183,0.16948903556039,0.186111773914244,0.161896730468451,0.239179337890426,0.218993023118764,0.242970743857494,0.25416873649496,0.37870901389503,0.372053663246672,0.349257969433454,0.347714854254901,0.583204827293238,0.626039267263642,0.614348812259387,0.598519620572428,1.02934476156823,1.01951208839017,1.00770879474046,0.952614684450246,1.85120627061781,1.90182650039903,1.94259035176836,1.91949562453923,6.04313131555482,5.43964156233764,5.73421884600195,5.83253255598064,0.114286759146199,0.133273315327473,0.109996063675364,0.124490049715443,0.127385066070344,0.180130719281232,0.178256533109556,0.154273191599272,0.165872255647223,0.168821425885432,0.28186117835077,0.251270510536771,0.27931400138525,0.300771987820169,0.273103213991723,0.437566389003882,0.449538499959431,0.460879799586925,0.458089779764158,0.447260712628346,0.691434859165445,0.655741154622124,0.686366258055556,0.735413254064352,0.771843118236479,1.08104932737724,1.19991208031928,1.1601355479534,1.20143080597631,1.14481003344475,1.98388602976686,2.11604593313438,1.94052322346785,2.02082491233308,2.05951697563683,3.68759477529255,3.79498727603388,3.56580676986966,3.54482956852156,3.70174585638675,9.71398539947739,9.42432144742958,10.6178986862871,9.52147362760532,10.1334001274142,0.165531675443833,0.176223514850907,0.154938492126777,0.162830351254122,0.174280817435543,0.170861966569809,0.300135636340885,0.276247830338175,0.301195147175386,0.277083154139914,0.247759937319591,0.33427553410437,0.449076731978321,0.463779951449253,0.494294841430889,0.441909467708122,0.521664488996043,0.467286435059479,0.769235923683706,0.809445106566863,0.764605649835669,0.826925421758879,0.715240219031191,0.813275304843205,1.24253052545302,1.19062436681712,1.18399872633056,1.30946505625601,1.15524921634104,1.17888889739587,1.96933555511339,1.96680578041622,2.03294836981968,1.93714726612379,2.12512201830679,1.86016348531546,3.34677019608374,3.39796143416603,3.39637621729111,3.23934625196479,3.37867273445924,3.5660082191642,6.1630579917585,6.10149229863748,5.864625833094,6.16466966214501,5.2002199245877,6.13894614516554,15.8887481912655,16.3539948499809,15.6784425464229,15.4378193123852,15.0881844581665,15.7501755994877,0.200622322319755,0.219082697732329,0.209998945858248,0.233862715371426,0.229357569488302,0.230410079764084,0.213964128107104,0.415160266616706,0.433464549992116,0.374053149932916,0.40333680526584,0.358748865942164,0.386667267917199,0.401156539956126,0.673952315417782,0.781372871157207,0.644976903539819,0.681591363709768,0.689328377771561,0.768246994150954,0.752440163016473,1.2886638155977,1.23130451872683,1.19038350233539,1.14963354610635,1.17620105569289,1.24652856407813,1.15949229697792,2.12159779162162,1.91845056932369,1.74293464995463,1.78070928827409,1.88613651805215,1.8776338159033,1.97205669953731,3.11011123068219,3.13442938800058,3.10511746027831,3.1830856157106,2.86395067472783,2.73037752628084,2.93963738328758,4.77982644609245,5.13625700507947,5.40077655070057,5.12520273479609,4.57018869307573,4.92404364988384,5.13448870785747,9.29283377765119,9.83442832750025,9.92395632939967,9.25642689380388,9.08889380375398,8.58472898824726,8.94864075883516,23.6306044864239,22.2664262582234,20.262355963246,22.1044025683282,23.277284466908,22.6688769952163,24.5190756894092,0.307626601229683,0.298771593603054,0.301461122613569,0.313128724260093,0.306123374829326,0.278513459196692,0.270393767444513,0.269361300902575,0.539548123689399,0.581891539095062,0.596624907098301,0.590490702416323,0.603854887105194,0.554255835438952,0.590040522630652,0.628009828357167,1.08248384574214,0.952884669320623,0.908714615509474,0.995168510923815,1.08032042818616,1.10106186955292,1.05396459431956,1.12243591924428,1.52678870785067,1.86613861293071,1.78018727492272,1.73897347734617,1.76168692700673,1.7912357253961,1.72556822300971,1.66150165977337,2.42221185064496,2.71907551233336,2.71327219003125,2.47820847558168,2.91495152113999,2.74073411357742,2.87120222589464,2.73702298261566,4.15796032930333,4.44268279387044,4.04362807129299,4.3771068957823,4.63609676208412,4.18269994747188,4.01353389065128,4.75917058594225,7.09093764306099,7.26189428399154,7.04816537271152,7.22796232214058,7.77284605816768,6.66707164157173,7.23040886222896,6.84074758531548,11.979288022983,13.304459191472,12.9735163723366,12.4957645318739,12.8535274357677,11.9055317237522,12.4068817747269,12.5075710343652,31.8806974764591,30.8811928340967,32.0639341186529,31.9828030099171,32.7654520500942,32.7656685276798,32.9164675235846,32.2555427828065,0.382120752092017,0.382785003827698,0.391885760314957,0.375370084135015,0.396197105177704,0.384778827178787,0.349041765195565,0.371973898519803,0.393837701629543,0.830521839191275,0.740955843636142,0.839892355734135,0.812871904897165,0.752845763797635,0.803483960101702,0.777721342622635,0.812162319298602,0.702202311373871,1.34356619531955,1.54335380567254,1.40814892356012,1.38263784843146,1.59238302072786,1.43609817860949,1.38593468029258,1.37828168091378,1.49965552794514,2.39917576783927,2.25796241030013,2.35484809679609,2.11016013925478,2.09905799072783,2.23502236912448,2.35655296247112,2.40395076037346,2.31626926807736,3.80536756818433,3.5133521977437,4.0459457285602,3.7738685480507,3.74816629277688,3.64393211684503,3.78309982926531,3.82883832709154,3.67297003574001,5.97296417831207,6.42517605662863,5.52253531650955,5.82508428809037,5.57286656690741,5.78986513521429,5.95257484871143,5.92454336574649,5.14116693438063,9.19664563030902,9.47121121945072,9.60877396121836,9.56357353342505,10.0002138474084,9.42234491964042,10.4194147313874,9.14302552037171,8.93469621474552,17.7959807447815,17.3446855392194,17.7667058481535,17.3114622709163,17.3596771006433,16.629104458959,16.2803121321547,17.5587734737861,17.6723156897978,39.4251088716789,37.9839509674709,41.112509605264,39.7811503345625,40.2269022427912,40.3966705446532,39.5754426253879,38.2270874630387,36.2908974563112],"rsq":[0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.37553032135553,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.377163362922495,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.375035358588893,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377412998189026,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.377317133160201,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.376480335242765,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.375415726730873,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.378917832652995,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.373820672382339,0.341046150707402,0.341046150707402,0.346318457208177,0.346318457208177,0.343861126044942,0.343861126044942,0.345047495601077,0.345047495601077,0.344467904548118,0.344467904548118,0.341587317058591,0.341587317058591,0.339004854456466,0.339004854456466,0.337192642202061,0.337192642202061,0.343753490465033,0.343753490465033,0.34810975786106,0.34810975786106,0.34810975786106,0.351745534976126,0.351745534976126,0.351745534976126,0.34758587140929,0.34758587140929,0.34758587140929,0.347387954911177,0.347387954911177,0.347387954911177,0.34494065066516,0.34494065066516,0.34494065066516,0.344120134085989,0.344120134085989,0.344120134085989,0.343072498186702,0.343072498186702,0.343072498186702,0.341013669865034,0.341013669865034,0.341013669865034,0.342245265829951,0.342245265829951,0.342245265829951,0.354756311791188,0.354756311791188,0.354756311791188,0.354756311791188,0.350725436005471,0.350725436005471,0.350725436005471,0.350725436005471,0.351549606473407,0.351549606473407,0.351549606473407,0.351549606473407,0.349090520106969,0.349090520106969,0.349090520106969,0.349090520106969,0.350384927153213,0.350384927153213,0.350384927153213,0.350384927153213,0.34987076258395,0.34987076258395,0.34987076258395,0.34987076258395,0.346497036234182,0.346497036234182,0.346497036234182,0.346497036234182,0.346136880197868,0.346136880197868,0.346136880197868,0.346136880197868,0.347835058607209,0.347835058607209,0.347835058607209,0.347835058607209,0.358661270388647,0.358661270388647,0.358661270388647,0.358661270388647,0.358661270388647,0.357940594417092,0.357940594417092,0.357940594417092,0.357940594417092,0.357940594417092,0.357096317858756,0.357096317858756,0.357096317858756,0.357096317858756,0.357096317858756,0.35642701686876,0.35642701686876,0.35642701686876,0.35642701686876,0.35642701686876,0.355825985587405,0.355825985587405,0.355825985587405,0.355825985587405,0.355825985587405,0.355486217844384,0.355486217844384,0.355486217844384,0.355486217844384,0.355486217844384,0.359063300156699,0.359063300156699,0.359063300156699,0.359063300156699,0.359063300156699,0.355026235323443,0.355026235323443,0.355026235323443,0.355026235323443,0.355026235323443,0.350790743038428,0.350790743038428,0.350790743038428,0.350790743038428,0.350790743038428,0.364899668072189,0.364899668072189,0.364899668072189,0.364899668072189,0.364899668072189,0.364899668072189,0.36121009008021,0.36121009008021,0.36121009008021,0.36121009008021,0.36121009008021,0.36121009008021,0.36364519148834,0.36364519148834,0.36364519148834,0.36364519148834,0.36364519148834,0.36364519148834,0.364571420472884,0.364571420472884,0.364571420472884,0.364571420472884,0.364571420472884,0.364571420472884,0.360909988774516,0.360909988774516,0.360909988774516,0.360909988774516,0.360909988774516,0.360909988774516,0.35798608389949,0.35798608389949,0.35798608389949,0.35798608389949,0.35798608389949,0.35798608389949,0.360415619173178,0.360415619173178,0.360415619173178,0.360415619173178,0.360415619173178,0.360415619173178,0.355534533968209,0.355534533968209,0.355534533968209,0.355534533968209,0.355534533968209,0.355534533968209,0.355589115202991,0.355589115202991,0.355589115202991,0.355589115202991,0.355589115202991,0.355589115202991,0.368415072178648,0.368415072178648,0.368415072178648,0.368415072178648,0.368415072178648,0.368415072178648,0.368415072178648,0.358434909223188,0.358434909223188,0.358434909223188,0.358434909223188,0.358434909223188,0.358434909223188,0.358434909223188,0.366642880824469,0.366642880824469,0.366642880824469,0.366642880824469,0.366642880824469,0.366642880824469,0.366642880824469,0.363584629170849,0.363584629170849,0.363584629170849,0.363584629170849,0.363584629170849,0.363584629170849,0.363584629170849,0.3621538217172,0.3621538217172,0.3621538217172,0.3621538217172,0.3621538217172,0.3621538217172,0.3621538217172,0.36047123270955,0.36047123270955,0.36047123270955,0.36047123270955,0.36047123270955,0.36047123270955,0.36047123270955,0.360763411135306,0.360763411135306,0.360763411135306,0.360763411135306,0.360763411135306,0.360763411135306,0.360763411135306,0.363583927609312,0.363583927609312,0.363583927609312,0.363583927609312,0.363583927609312,0.363583927609312,0.363583927609312,0.366582117406818,0.366582117406818,0.366582117406818,0.366582117406818,0.366582117406818,0.366582117406818,0.366582117406818,0.370552689655383,0.370552689655383,0.370552689655383,0.370552689655383,0.370552689655383,0.370552689655383,0.370552689655383,0.370552689655383,0.368273338098993,0.368273338098993,0.368273338098993,0.368273338098993,0.368273338098993,0.368273338098993,0.368273338098993,0.368273338098993,0.368935598833224,0.368935598833224,0.368935598833224,0.368935598833224,0.368935598833224,0.368935598833224,0.368935598833224,0.368935598833224,0.367649578568047,0.367649578568047,0.367649578568047,0.367649578568047,0.367649578568047,0.367649578568047,0.367649578568047,0.367649578568047,0.366903320410018,0.366903320410018,0.366903320410018,0.366903320410018,0.366903320410018,0.366903320410018,0.366903320410018,0.366903320410018,0.371224805314208,0.371224805314208,0.371224805314208,0.371224805314208,0.371224805314208,0.371224805314208,0.371224805314208,0.371224805314208,0.367681953360243,0.367681953360243,0.367681953360243,0.367681953360243,0.367681953360243,0.367681953360243,0.367681953360243,0.367681953360243,0.365412679361025,0.365412679361025,0.365412679361025,0.365412679361025,0.365412679361025,0.365412679361025,0.365412679361025,0.365412679361025,0.367048659116737,0.367048659116737,0.367048659116737,0.367048659116737,0.367048659116737,0.367048659116737,0.367048659116737,0.367048659116737,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.376222809931967,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.373780374118195,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372132376933152,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372829937827533,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.372215922449597,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.374524980558583,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.36890640927816,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368507488006661,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694,0.368585597886694]},"columns":[{"accessor":"cor","name":"Correlation","type":"numeric","filterable":true},{"accessor":"npred","name":"p","type":"numeric","filterable":true},{"accessor":"predictor","name":"Predictor","type":"character"},{"accessor":"coverage","name":"Coverage","type":"numeric"},{"accessor":"estimate","name":"Estimate","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"bias","name":"Bias","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"mse","name":"MSE","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}},{"accessor":"rsq","name":"R2","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}}}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"4f1052fd0fe4bc15ee914c03752e229e","key":"4f1052fd0fe4bc15ee914c03752e229e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<p>To keep all four plots in the same scale, I have standardized the
horizontal axis values. In this heat map, darker colors represent larger
values (greater standard deviation). The pattern for Bias and MSE is
similar: performing model selection with a great number of highly
correlated predictors is likely to produced highly biased estimates. As
expected, Coverage follows an inverted pattern from Bias and MSE: highly
biased estimates fall out of the 95% CI coverage.</p>
<p>These plots make clear that our best case scenario is to have few,
weakly correlated predictors. Of course, this is a setting rarely seen
in empirical research – whats the point of going through model selection
if you have only a handful of variables? What should really get our
attention here is that bias in estimates is likely to get bigger if
model selection is naively performed with little prior information about
the data generating system to filter out candidate models. We have seen
that sample size, SNR, number of predictors, and correlation between
parameters with themselves and with the response variable, are
characteristics of the model that each in their own way contributes to
producing biased estimates. I encourage you to use this companion <a
href="https://marwin.shinyapps.io/model-selection-app/">shinyapp</a> to
play with different scenarios to practice what we’ve been discussing so
far.</p>
<h1 id="visualizing-distributions">Visualizing distributions</h1>
<p>We’ve discussed earlier how dropping a predictor from the model can
distort the coefficient sampling distribution of the remaining ones when
they’re not orthogonal. However, even when the preferred (or “correct”)
model is selected, there is no guarantee about obtaining sound
regression coefficient estimates. In this final example, we’ll show that
if by chance the “correct” model is achieved by model selection, the
sampling distributions of the resulting regression coefficients might be
different whether we condition on arriving at the correct model or on
the correct model being known in advance.</p>
<p>Consider this example from <span class="citation"
data-cites="berkStatisticalInferenceModel2010">Berk et al. (<a
href="#ref-berkStatisticalInferenceModel2010"
role="doc-biblioref">2010</a>)</span>. As with the other examples, we’ll
implement forward stepwise regression using the AIC as a fit criterion.
The full regression model takes the form of</p>
<p><span class="math display" id="eq:b10">\[\begin{equation}
y_i = \beta_0 + \beta_1w_i + \beta_2x_i + \beta_3z_i + \varepsilon_i
\tag{9}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\beta_0\)</span> = 3.0, <span
class="math inline">\(\beta_1\)</span> = 0.0, <span
class="math inline">\(\beta_2\)</span> = 1.0, and <span
class="math inline">\(\beta_3\)</span> = 2.0. The variances and
covariance are set as: <span
class="math inline">\(\sigma^2_\varepsilon\)</span> = 10.0, <span
class="math inline">\(\sigma^2_w\)</span> = 5.0, <span
class="math inline">\(\sigma^2_x\)</span> = 6.0, <span
class="math inline">\(\sigma^2_z\)</span> = 7.0, <span
class="math inline">\(\sigma_{w,x}\)</span> = 4.0, <span
class="math inline">\(\sigma_{w,z}\)</span> = 5.0, and <span
class="math inline">\(\sigma_{x,z}\)</span> = 5.0. The sample size is
200.</p>
<p>Note that <span class="citation"
data-cites="berkStatisticalInferenceModel2010">Berk et al. (<a
href="#ref-berkStatisticalInferenceModel2010"
role="doc-biblioref">2010</a>)</span> uses the term <em>preferred</em>
model instead of <em>correct</em> model. They do so because a model that
excludes <span class="math inline">\(W\)</span> can also be called
correct the same as one like <a href="#eq:b10">(9)</a>, as long as <span
class="math inline">\(\beta_1\)</span> = 0 is allowed. To be consistent
with the original text, we’ll use <em>preferred</em> to refer to the
model with <span class="math inline">\(W\)</span> excluded. This model
is preferred because it generates the same conditional expectations for
the response using up one less degree of freedom. The plots show the
regression estimates <em>t</em>-values. “A distribution of t-values is
more informative than a distribution of regression coefficients because
it takes the regression coefficients and their standard errors into
account” <span class="citation"
data-cites="berkStatisticalInferenceModel2010">(<a
href="#ref-berkStatisticalInferenceModel2010" role="doc-biblioref">Berk
et al., 2010, p. 266</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>reps</span> <span class='op'>=</span> <span class='fl'>1000</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='va'>Sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,
                  <span class='fl'>4</span>,<span class='fl'>6</span>,<span class='fl'>5</span>, 
                  <span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>7</span><span class='op'>)</span>, <span class='va'>p</span>, <span class='va'>p</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>200</span>
<span class='va'>betas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># values with model selection</span>
<span class='va'>rsq</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>coefs</span> <span class='op'>&lt;-</span> <span class='va'>cover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cover</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>betas</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
  <span class='va'>sel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/step.html'>step</a></span><span class='op'>(</span><span class='va'>fit</span>, k <span class='op'>=</span> <span class='fl'>2</span>, trace <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sel</span><span class='op'>)</span>
  <span class='va'>tvals</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>coefs</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tvals</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span>  <span class='va'>tvals</span>
  <span class='va'>rsq</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>r.squared</span>
<span class='op'>}</span>

<span class='co'># values without model selection</span>
<span class='va'>rsq_pref</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>coefs_pref</span> <span class='op'>&lt;-</span> <span class='va'>cover_pref</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>reps</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>coefs_pref</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cover_pref</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>reps</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>X</span> <span class='op'>&lt;-</span>  <span class='fu'>MASS</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/MASS/man/mvrnorm.html'>mvrnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span> , <span class='va'>Sigma</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>X</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>betas</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fl'>0</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Xy</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"w"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span><span class='op'>)</span>, <span class='st'>"y"</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span>, data <span class='op'>=</span> <span class='va'>Xy</span><span class='op'>)</span>
  <span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
  <span class='va'>tvals</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>coefs_pref</span><span class='op'>[</span><span class='va'>i</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tvals</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span>  <span class='va'>tvals</span>
  <span class='va'>rsq_pref</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>r.squared</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>full_model</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>coefs_pref</span><span class='op'>)</span>
<span class='va'>pref_selected</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span>,<span class='st'>"x"</span><span class='op'>]</span>  <span class='op'>&amp;</span> <span class='va'>coefs</span><span class='op'>[</span>,<span class='st'>"z"</span><span class='op'>]</span><span class='op'>)</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='va'>x_included</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span>,<span class='st'>"x"</span><span class='op'>]</span><span class='op'>)</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='va'>z_included</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>coefs</span><span class='op'>[</span>,<span class='st'>"z"</span><span class='op'>]</span><span class='op'>)</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='va'>res_df</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='st'>"full"</span> <span class='op'>=</span> <span class='va'>full_model</span>, <span class='st'>"pref"</span> <span class='op'>=</span> <span class='va'>pref_selected</span>, 
                          <span class='st'>"x_included"</span> <span class='op'>=</span> <span class='va'>x_included</span>, <span class='st'>"z_included"</span> <span class='op'>=</span> <span class='va'>z_included</span>, .id<span class='op'>=</span><span class='st'>"sim"</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>xplot</span> <span class='op'>&lt;-</span> <span class='va'>res_df</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sim</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"full"</span>, <span class='st'>"x_included"</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, fill <span class='op'>=</span> <span class='va'>sim</span>, color <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span>adjust <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.55</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"t-values for Regressor X"</span>, y <span class='op'>=</span> <span class='st'>"Density"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Conditional on"</span>,
                      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"preferred model being known"</span>, <span class='st'>"predictor being included in a model"</span><span class='op'>)</span>,
                      values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Conditional on"</span>,
                      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"preferred model being known"</span>, <span class='st'>"predictor being included in a model"</span><span class='op'>)</span>,
                      values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>zplot</span> <span class='op'>&lt;-</span> <span class='va'>res_df</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sim</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"full"</span>, <span class='st'>"z_included"</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>z</span>, fill <span class='op'>=</span> <span class='va'>sim</span>, color <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span>adjust <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,
        axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.55</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"t-values for Regressor Z"</span>, y <span class='op'>=</span> <span class='st'>"Density"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"none"</span>, color <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>


<span class='va'>xplot</span> <span class='op'>+</span> <span class='va'>zplot</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>'collect'</span><span class='op'>)</span> <span class='op'>&amp;</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>'top'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:predinc"></span>
<img src="model-selection-bias_files/figure-html5/predinc-1.png" alt="Stepwise regression sampling distributions of the regression coefficient *t*-values for regressors X and Z. Red density plot is is conditional on the preferred model being known. The blue density plot is conditional on the regressor being included in a model" width="1950" data-distill-preview=1 />
<p class="caption">
Figure 4: Stepwise regression sampling distributions of the
regression coefficient <em>t</em>-values for regressors X and Z. Red
density plot is is conditional on the preferred model being known. The
blue density plot is conditional on the regressor being included in a
model
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>xpref_plot</span> <span class='op'>&lt;-</span> <span class='va'>res_df</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sim</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"full"</span>, <span class='st'>"pref"</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, fill <span class='op'>=</span> <span class='va'>sim</span>, color <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span>adjust <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.55</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"t-values for Regressor X"</span>, y <span class='op'>=</span> <span class='st'>"Density"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Conditional on"</span>,
                      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"preferred model being known"</span>, <span class='st'>"preferred model being selected"</span><span class='op'>)</span>,
                      values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Conditional on"</span>,
                      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"preferred model being known"</span>, <span class='st'>"preferred model being selected"</span><span class='op'>)</span>,
                      values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>zpref_plot</span> <span class='op'>&lt;-</span> <span class='va'>res_df</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sim</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"full"</span>, <span class='st'>"pref"</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>z</span>, fill <span class='op'>=</span> <span class='va'>sim</span>, color <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span>adjust <span class='op'>=</span> <span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,
        axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.55</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red3"</span>, <span class='st'>"dodgerblue3"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"t-values for Regressor Z"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"none"</span>, color <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>

<span class='va'>xpref_plot</span> <span class='op'>+</span> <span class='va'>zpref_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>guides <span class='op'>=</span> <span class='st'>'collect'</span><span class='op'>)</span> <span class='op'>&amp;</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>'top'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:prefcond"></span>
<img src="model-selection-bias_files/figure-html5/prefcond-1.png" alt="Stepwise regression sampling distributions of the regression coefficient *t*-values for regressors X and Z. Red density plot is is conditional on the preferred model being known. The blue density plot is conditional on the preferred model being selected" width="1950" />
<p class="caption">
Figure 5: Stepwise regression sampling distributions of the
regression coefficient <em>t</em>-values for regressors X and Z. Red
density plot is is conditional on the preferred model being known. The
blue density plot is conditional on the preferred model being selected
</p>
</div>
</div>
<p>In both figures <a href="#fig:predinc">4</a> and <a href="#fig:prefcond">5</a> the red
density plot represents the regression estimates <em>t</em>-values
distribution when no model selection is performed. In <a href="#fig:predinc">4</a>
the blue density plot show the distributions when either <span
class="math inline">\(X\)</span> or <span
class="math inline">\(Z\)</span> are included in the model. For
<a href="#fig:prefcond">5</a> the blue distribution refers to distributions of
either <span class="math inline">\(X\)</span> or <span
class="math inline">\(Z\)</span> <em>t</em>-values when the preferred
model is selected.</p>
<p>The contrast between red and blue curves are apparent. The difference
that is the most striking are in <em>t</em>-values distributions
post-model-selection for regressor <span
class="math inline">\(Z\)</span> when conditioned on the regressor being
included in a model. This curve displays a bimodal distribution and
highly biased mean and standard deviaton, as summarized below.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>res_df</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>sim</span><span class='op'>)</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Mx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, 
            x_sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
            Mz <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>z</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
            z_sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>z</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>sim <span class='op'>=</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
    <span class='va'>sim</span> <span class='op'>==</span> <span class='st'>"full"</span> <span class='op'>~</span> <span class='st'>"Full model"</span>,
    <span class='va'>sim</span> <span class='op'>==</span> <span class='st'>"pref"</span> <span class='op'>~</span> <span class='st'>"Preferred model"</span>,
    <span class='va'>sim</span> <span class='op'>==</span> <span class='st'>"x_included"</span> <span class='op'>~</span> <span class='st'>"X included"</span>,
    <span class='va'>sim</span> <span class='op'>==</span> <span class='st'>"z_included"</span> <span class='op'>~</span> <span class='st'>"Z included"</span>
  <span class='op'>)</span><span class='op'>)</span> |&gt; 
  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Model"</span>,
                             <span class='st'>"$M_x$"</span>,
                              <span class='st'>"$\\sigma_x$"</span>,
                             <span class='st'>"$M_z$"</span>,
                              <span class='st'>"$\\sigma_z$"</span><span class='op'>)</span>,
               digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;"><span
class="math inline">\(M_x\)</span></th>
<th style="text-align: right;"><span
class="math inline">\(\sigma_x\)</span></th>
<th style="text-align: right;"><span
class="math inline">\(M_z\)</span></th>
<th style="text-align: right;"><span
class="math inline">\(\sigma_z\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Full model</td>
<td style="text-align: right;">2.183</td>
<td style="text-align: right;">1.014</td>
<td style="text-align: right;">4.745</td>
<td style="text-align: right;">1.055</td>
</tr>
<tr class="even">
<td style="text-align: left;">Preferred model</td>
<td style="text-align: right;">2.648</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">4.456</td>
<td style="text-align: right;">0.951</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X included</td>
<td style="text-align: right;">2.648</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">4.456</td>
<td style="text-align: right;">0.951</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z included</td>
<td style="text-align: right;">2.648</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">5.748</td>
<td style="text-align: right;">2.602</td>
</tr>
</tbody>
</table>
</div>
<p>It is especially telling observing those plots that the assumed
underlying distribution can be very different from what is obtained.
Statistical inference performed in such scenarios would be misleading.
Figure <a href="#fig:prefcond">5</a> confirms that conditioning on arriving at the
preferred model does not guarantee trustable estimates.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Model selection methods are routine in research on the social and
behavioral sciences, and commonly taught in applied statistics courses
and textbooks. However, little is mentioned about the biased estimates
obtained when such procedures are carried. With simulated data we have
identified specific characteristics of the data generating model that
can potentially increase the bias in estimates obtained through variable
selection. Thus, we can conclude that post-model-selection sampling
distribution can deviate greatly from the assumed underlying
distribution, even when the best representative model of the data
generation process has been selected.</p>
<h2 class="appendix" id="acknowledgments">Acknowledgments</h2>
<p>Special thanks to <a href="https://twitter.com/wdonald_1985">Donald
Williams</a> for mentoring me in this project and <a
href="https://twitter.com/rafavsbastos">Rafael Bastos</a> for review and
feedback.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
data-line-spacing="2" role="doc-bibliography">
<div id="ref-berk2010" class="csl-entry" role="doc-biblioentry">
Berk, R. (2010). What you can and can’t properly do with regression.
<em>Journal of Quantitative Criminology</em>, <em>26</em>(4), 481–487.
<a
href="https://doi.org/10.1007/s10940-010-9116-4">https://doi.org/10.1007/s10940-010-9116-4</a>
</div>
<div id="ref-berkValidPostselectionInference2013" class="csl-entry"
role="doc-biblioentry">
Berk, R., Brown, L., Buja, A., Zhang, K., &amp; Zhao, L. (2013). Valid
post-selection inference. <em>The Annals of Statistics</em>,
<em>41</em>(2), 802–837. <a
href="https://doi.org/10.1214/12-AOS1077">https://doi.org/10.1214/12-AOS1077</a>
</div>
<div id="ref-berkStatisticalInferenceModel2010" class="csl-entry"
role="doc-biblioentry">
Berk, R., Brown, L., &amp; Zhao, L. (2010). Statistical <span>Inference
After Model Selection</span>. <em>Journal of Quantitative
Criminology</em>, <em>26</em>(2), 217–236. <a
href="https://doi.org/10.1007/s10940-009-9077-7">https://doi.org/10.1007/s10940-009-9077-7</a>
</div>
<div id="ref-cohen1983" class="csl-entry" role="doc-biblioentry">
Cohen, J., &amp; Cohen, P. (1983). <em>Applied <span>Multiple
Regression</span>/<span>Correlation Analysis</span> for the
<span>Behavioral Sciences</span></em> (2nd ed.).
</div>
<div id="ref-flora2017statistical" class="csl-entry"
role="doc-biblioentry">
Flora, D. B. (2017). <em>Statistical methods for the social and
behavioural sciences: A model-based approach</em>. SAGE Publications. <a
href="https://books.google.com.br/books?id=4mcCDgAAQBAJ">https://books.google.com.br/books?id=4mcCDgAAQBAJ</a>
</div>
<div id="ref-lukacsModelSelectionBias2009" class="csl-entry"
role="doc-biblioentry">
Lukacs, P. M., Burnham, K. P., &amp; Anderson, D. R. (2009). Model
selection bias and <span>Freedman</span>â€™s paradox. <em>Annals of the
Institute of Statistical Mathematics</em>, <em>62</em>(1), 117. <a
href="https://doi.org/10.1007/s10463-009-0234-4">https://doi.org/10.1007/s10463-009-0234-4</a>
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Simulating%20post%20selection%20inference&amp;url=https%3A%2F%2Fmarwincarmo.github.io%2Fposts%2F2021-12-20-model-selection-bias%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fmarwincarmo.github.io%2Fposts%2F2021-12-20-model-selection-bias%2F&amp;title=Simulating%20post%20selection%20inference">
        <i class="fab fa-linkedin"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/marwincarmo/marwincarmo.github.io/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/marwincarmo/marwincarmo.github.io">https://github.com/marwincarmo/marwincarmo.github.io</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Carmo (2022, April 7). Marwin Carmo: Simulating post selection inference. Retrieved from https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{carmo2022simulating,
  author = {Carmo, Marwin},
  title = {Marwin Carmo: Simulating post selection inference},
  url = {https://marwincarmo.github.io/posts/2021-12-20-model-selection-bias/},
  year = {2022}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
